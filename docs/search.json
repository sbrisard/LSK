[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Notes on the Lyapunov–Schmidt–Koiter asymptotic method",
    "section": "",
    "text": "1 Welcome!\nThese are my notes on the LSK method for the analysis of the stability and bifurcation(s) of a conservative system. These notes are based on several references: the initial PhD thesis of Warner Tjardus Koiter (1945) as well as some graphical illustrations from his lecture notes (W. T. Koiter and Heijden 2009). I enjoyed the concise presentation of Nguyen (2000) as well as the lecture notes of Triantafyllidis (2017). Finally, the chapter by Potier-Ferry (1987) helped me clear some issues.\nThese notes by Sébastien Brisard are licensed under a Creative Commons Attribution 4.0 International License. To view a copy of this license, visit http://creativecommons.org/licenses/by/4.0/.\nI hope the reader will find these notes useful, even though there are still a few points which I do not fully understand (they are clearly indicated in the text).\n\n\n\n\n\n\n\nKoiter, W. T., and A. M. A. van der Heijden. 2009. W.T. Koiter’s Elastic Stability of Solids and Structures. Cambridge ; New York: Cambridge University Press.\n\n\nKoiter, Warner Tjardus. 1945. “The Stability of Elastic Equilibrium.” PhD thesis, Delft: Technische Hooge School Delft.\n\n\nNguyen, Quoc-Son. 2000. Stabilité et mécanique non linéaire. Paris: Hermès Science Publications.\n\n\nPotier-Ferry, Michel. 1987. “Foundations of Elastic Postbuckling Theory.” In Buckling and Post-Buckling, 1–82. Lecture Notes in Physics. Springer, Berlin, Heidelberg. https://doi.org/10.1007/BFb0009197.\n\n\nTriantafyllidis, Nicolas. 2017. “Stability of Solids: From Structures to Materials.” Lecture Notes. Palaiseau, France: École polytechnique."
  },
  {
    "objectID": "problem_setting.html",
    "href": "problem_setting.html",
    "title": "2  Setting up the stage",
    "section": "",
    "text": "3 Let’s define a convenient alias to the Hessian\nE2 = dE[2, 0]\ndef simplify_E2(expr): expr = expr.expand() coeff_E2 = expr.coeff(E2).expand() coeff_E2_v = coeff_E2.coeff(v) coeff_E2_v_hat = (coeff_E2 - coeff_E2_v * v).expand().coeff(v_hat) return (expr - (coeff_E2_v * E2 * v + coeff_E2_v_hat * E2 * v_hat)).expand()\nassert simplify_E2(E2 * v) == 0 assert simplify_E2(E2 * v_hat) == 0 assert simplify_E2(3 * v + 4 * v_hat + 5 * v * v_hat + 6 * E2 * v + 7 * E2 * v_hat + 8 * E2 * v * v_hat) == 3 * v + 4 * v_hat + 5 * v * v_hat"
  },
  {
    "objectID": "mixed_derivatives.html",
    "href": "mixed_derivatives.html",
    "title": "3  Expression of the mixed derivatives of the energy",
    "section": "",
    "text": "\\[\n\\newcommand{\\E}{\\mathcal{E}}\n\\newcommand{\\reals}{\\mathbb{R}}\n\\]\nEq. (2.1) holds for all \\(\\lambda\\). Upon successive derivations with respect to \\(\\lambda\\), it is found that, for all \\(\\hat{u} \\in U\\) and \\(\\lambda \\in \\reals\\)\n\\[\n\\E_{,uu}[u^\\ast(\\lambda), \\lambda; \\dot{u}^\\ast(\\lambda), \\hat{u}] + \\E_{,u\\lambda}[u^\\ast(\\lambda), \\lambda; \\hat{u}] = 0\n\\]\nand\n\\[\n\\begin{aligned}[b]\n\\E_{,uuu}[u^\\ast(\\lambda), \\lambda; \\dot{u}^\\ast(\\lambda), \\dot{u}^\\ast(\\lambda), \\hat{u}] + 2\\E_{,uu\\lambda}[u^\\ast(\\lambda), \\lambda; \\dot{u}^\\ast(\\lambda), \\hat{u}] &\\\\\n+ \\E_{,u\\lambda\\lambda}[u^\\ast(\\lambda), \\lambda; \\hat{u}] + \\E_{,uu}[u^\\ast(\\lambda), \\lambda; \\ddot{u}^\\ast(\\lambda), \\hat{u}] &= 0\n\\end{aligned}\n\\]\nand, at the critical point\n\\[\n\\begin{gather}\n  \\E_2(\\dot{u}_0, \\bullet) + \\E_{,u\\lambda}(u_0, \\lambda_0; \\bullet) = 0,\\\\\n  \\E_3(\\dot{u}_0, \\dot{u}_0, \\bullet) + 2\\E_{,uu\\lambda}(u_0, \\lambda_0; \\dot{u}_0, \\bullet) + \\E_{,u\\lambda\\lambda}(u_0, \\lambda_0; \\bullet) + \\E_2(\\ddot{u}_0, \\bullet) = 0.\n\\end{gather}\n\\]\nCombining with Eq. (2.2), the mixed derivatives \\(\\E_{,u\\lambda}(u_0, \\lambda_0; \\bullet)\\), \\(\\E_{,uu\\lambda}(u_0, \\lambda_0; \\bullet, \\bullet)\\) and \\(\\E_{,u\\lambda\\lambda}(u_0, \\lambda_0; \\bullet)\\) can be expressed as functions of \\(u_0\\), \\(\\dot{u}_0\\), \\(\\ddot{u}_0\\), \\(\\E_2\\) and \\(\\E_3\\). More generally, it is shown in Appendix compléter référence that the following mixed derivatives can be thus expressed\n\\[\n\\E_{,u\\lambda}(u_0, \\lambda_0; \\bullet) = -\\E_2(\\dot{u}_0, \\bullet),\n\\]\n\\[\n\\E_{,uu\\lambda}(u_0, \\lambda_0; \\bullet, \\bullet) = -\\E_3(\\dot{u}_0, \\bullet, \\bullet) + \\dot{\\E}_2(\\bullet, \\bullet),\n\\]\n\\[\n\\E_{,u\\lambda\\lambda}(u_0, \\lambda_0; \\bullet) = - \\E_2(\\ddot{u}_0, \\bullet) - 2\\dot{\\E}_2(\\dot{u}_0, \\bullet) + \\E_3(\\dot{u}_0, \\dot{u}_0, \\bullet),\n\\]\n\\[\n\\E_{,uuu\\lambda}(u_0, \\lambda_0; \\bullet, \\bullet, \\bullet) = -\\E_4(\\dot{u}_0, \\bullet, \\bullet, \\bullet) + \\dot{\\E}_3(\\bullet, \\bullet, \\bullet),\n\\]\n\\[\n\\E_{,uu\\lambda\\lambda}(u_0, \\lambda_0; \\bullet, \\bullet) = - \\E_3(\\ddot{u}_0, \\bullet, \\bullet) + \\ddot{\\E}_2(\\bullet, \\bullet) - 2\\dot{\\E}_3(\\dot{u}_0, \\bullet, \\bullet) + \\E_4(\\dot{u}_0, \\dot{u}_0, \\bullet, \\bullet),\n\\]\n\\[\n\\begin{aligned}\n\\E_{,u\\lambda\\lambda\\lambda}(u_0, \\lambda_0; \\bullet) ={} & -\\E_2(\\dddot{u}_0, \\bullet) + 3\\E_3(\\dot{u}_0, \\ddot{u}_0, \\bullet) - \\E_4(\\dot{u}_0, \\dot{u}_0, \\dot{u}_0, \\bullet) - 3\\ddot{\\E}_2(\\dot{u}_0, \\bullet)\\\\\n  &-3\\dot{\\E}_2(\\ddot{u}_0, \\bullet)+ 3\\dot{\\E}_3(\\dot{u}_0, \\dot{u}_0, \\bullet).\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "parametrization.html#simplification-of-the-bifurcation-equations",
    "href": "parametrization.html#simplification-of-the-bifurcation-equations",
    "title": "5  Parametrization of the bifurcated branch",
    "section": "5.1 Simplification of the bifurcation equations",
    "text": "5.1 Simplification of the bifurcation equations\nThe bifurcation equations (4.10) and (4.11) have been derived in Chapter 4. Testing these equations with \\(\\hat{v} = v_i\\) delivers \\[\n\\xi_j \\, \\xi_k \\, \\bigl[ \\tfrac{1}{2} \\, \\E_3(v_i, v_j, v_k) + \\lambda_k \\, \\dot{\\E}_2(v_i, v_j) \\bigr] = 0\n\\tag{5.2}\\] and \\[\n\\begin{aligned}[b]\n\\xi_j \\, \\xi_k \\, \\xi_l \\, \\bigl[\n\\tfrac{1}{2} \\E_3(v_i, v_j, w_{kl})\n+ \\lambda_l \\, \\E_3(v_i, v_j, w_{k\\lambda})\n+ \\tfrac{1}{6} \\E_4(v_i, v_j, v_k, v_l) &\\\\\n+ \\tfrac{1}{2} \\lambda_l \\, \\dot{\\E}_2(v_i, w_{jk})\n+ \\lambda_k \\, \\lambda_l \\, \\dot{\\E}_2(v_i, w_{j\\lambda})\n+ \\tfrac{1}{2} \\lambda_{kl} \\, \\dot{\\E}_2(v_i, v_j) &\\\\\n+ \\tfrac{1}{2} \\lambda_l \\, \\dot{\\E}_3(v_i, v_j, v_k)\n+ \\tfrac{1}{2} \\lambda_k \\, \\lambda_l \\, \\ddot{\\E}_2(v_i, v_j) \\bigr] &= 0.\n\\end{aligned}\n\\tag{5.3}\\] for all \\(\\xi_1, \\ldots, \\xi_m \\in \\reals\\) and \\(i = 1, \\ldots, m\\).\nEq. (5.2) holds for all \\(\\xi_1, \\ldots, \\xi_m\\). Plugging \\(\\xi_i = \\order[1]{\\xi_i}\\) and using Eq. (5.1) delivers the first bifurcation equation \\[\n\\tfrac{1}{2}E_{ijk} \\, \\order[1]{\\xi_j} \\, \\order[1]{\\xi_k} + \\order[1]{\\lambda} \\, \\dot{E}_{ij} \\, \\order[1]{\\xi_j} = 0.\n\\tag{5.4}\\]\nSimilarly, Eq. (5.3) is simplified as follows (see proof in Section A.1) \\[\n\\begin{aligned}[b]\n\\tfrac{1}{3} E_{ijkl} \\, \\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k \\, \\order[1]{\\xi}_l\n+ \\order[1]{\\lambda} \\, \\bigl( \\dot{E}_{ijk} \\, \\order[1]{\\xi}_k + \\order[1]{\\lambda} \\, \\ddot{E}_{ij} \\bigr) \\, \\order[1]{\\xi}_j &\\\\\n+ \\bigl( E_{ijk} \\, \\order[1]{\\xi}_k + \\order[1]{\\lambda} \\, \\dot{E}_{ij} \\bigr) \\order[2]{\\xi}_j\n+ \\order[2]{\\lambda} \\, \\dot{E}_{ij} \\, \\order[1]{\\xi}_j & = 0.\n\\end{aligned}\n\\tag{5.5}\\]\nIn Eqs. (5.4) and (5.5), the following quantities have been introduced\n\\[\n\\dot{E}_{ij} = \\dot{\\E}_2(v_i, v_j),\n\\tag{5.6}\\] \\[\nE_{ijk} = \\E_3(v_i, v_j, v_k),\n\\tag{5.7}\\] \\[\n\\ddot{E}_{ij} = \\ddot{\\E}_2(v_i, v_j) + \\dot{\\E}_2(v_i, w_{j\\lambda}) + \\dot{\\E}_2(v_j, w_{i\\lambda}),\n\\tag{5.8}\\] \\[\n\\dot{E}_{ijk} = \\dot{\\E}_3(v_i, v_j, v_k) + \\dot{\\E}_2(v_i, w_{jk}) + \\dot{\\E}_2(v_j, w_{ik}) + \\dot{\\E}_2(v_k, w_{ij}),\n\\tag{5.9}\\] \\[\n\\begin{aligned}[b]\nE_{ijkl} ={}& \\E_4(v_i, v_j, v_k, v_l) + \\E_3(v_i, v_j, w_{kl})\\\\\n&+ \\E_3(v_i, v_k, w_{jl}) + \\E_3(v_i, v_l, w_{jk}).\n\\end{aligned}\n\\tag{5.10}\\]\n\n\n\n\n\n\nConsistency of the above definitions\n\n\n\nSince \\(\\E_2(v, \\bullet) = 0\\) for all \\(v \\in V\\), definitions (5.6) and (5.7) of \\(\\dot{E}_{ij}\\) and \\(E_{ijk}\\) can also be written \\[\n\\dot{E}_{ij} = \\dot{\\E}_2(v_i, v_j) + \\E_2(v_i, w_{j\\lambda}) + \\E_2(v_j, w_{i\\lambda})\n\\] and \\[\nE_{ijk} = \\E_3(v_i, v_j, v_k)  + \\E_2(v_i, w_{jk}) + \\E_2(v_j, w_{ik}) + \\E_2(v_k, w_{ij}),\n\\] wich shows the consistency with definitions (5.8) and (5.9) of \\(\\ddot{E}_{ij}\\) and \\(\\dot{E}_{ijk}\\)."
  },
  {
    "objectID": "parametrization.html#taylor-expansion-of-the-bifurcated-branch",
    "href": "parametrization.html#taylor-expansion-of-the-bifurcated-branch",
    "title": "5  Parametrization of the bifurcated branch",
    "section": "5.2 Taylor expansion of the bifurcated branch",
    "text": "5.2 Taylor expansion of the bifurcated branch\nWe now turn to \\(w\\), which was defined in Section 4.2 as an implicit function of \\(\\xi_1, \\ldots, \\xi_m\\) and \\(\\lambda\\). It is now defined as a function of the arc parameter \\(\\eta\\) as follows: \\(w(n) = w[\\xi_1(\\eta), \\ldots, \\xi_m(\\eta), \\lambda(\\eta)]\\). From the chain rule \\[\nw'(\\eta) = \\frac{\\partial w}{\\partial \\xi_i} \\, \\xi_i' + \\frac{\\partial w}{\\partial \\lambda} \\, \\lambda'\n\\] and \\[\nw''(\\eta) = \\frac{\\partial^2 w}{\\partial \\xi_i \\, \\partial \\xi_j} \\, \\xi_i' \\, \\xi_j'\n+ 2\\frac{\\partial w}{\\partial \\xi_i \\, \\partial \\lambda} \\, \\xi_i' \\, \\lambda'\n+ \\frac{\\partial w}{\\partial \\xi_i} \\, \\xi_i''\n+ \\frac{\\partial^2 w}{\\partial \\lambda^2} \\, \\lambda^{'2}\n+ \\frac{\\partial w}{\\partial \\lambda} \\, \\lambda''.\n\\]\nAt \\(\\eta = 0\\), the above identities reduce to \\[\nw'(0) = 0\n\\quad \\text{and} \\quad\nw''(0) = \\order[1]{\\xi_i} \\, \\order[1]{\\xi_j} \\, w_{ij}  + 2 \\order[1]{\\lambda} \\, \\order[1]{\\xi_i} \\, w_{i\\lambda}\n\\]\nWe deduce from the above the Taylor expansion of the bifurcated branch as \\(\\eta \\to 0\\) \\[\nu(\\eta) = u^\\ast[\\lambda(\\eta)] + \\order[1]{\\xi_i} \\, v_i + \\tfrac{1}{2} \\bigl( \\order[2]{\\xi_i} \\, v_i\n+ \\order[1]{\\xi_i} \\, \\order[1]{\\xi_j} \\, w_{ij}  + 2\\order[1]{\\lambda} \\, \\order[1]{\\xi_i} \\, w_{i\\lambda} \\bigr) + o(\\eta^2).\n\\]"
  },
  {
    "objectID": "kernel_hessian.html",
    "href": "kernel_hessian.html",
    "title": "5  Kernel of the hessian of the energy",
    "section": "",
    "text": "\\[\n\\newcommand{\\E}{\\mathcal{E}}\n\\newcommand{\\reals}{\\mathbb{R}}\n\\]\nThe kernel of the hessian of the energy, \\(\\E_2\\), is defined as follows\n\\[\nV = \\bigl\\{ u \\in U, \\E_2(u, u) = 0 \\bigr\\}.\n\\]\nSince \\(\\E_2\\) is a bilinear, symmetric and positive (but not poitive definite!) form, \\(V\\) is a vector subspace of \\(U\\).\nTo prove this result, we must show that, for all \\(u, v \\in V\\) and \\(\\alpha \\in \\reals\\), \\(w = u + \\alpha \\, v \\in V\\). From the bilinearity and symmetry of \\(\\E_2\\)\n\\[\n\\E_2(w, w) = \\E_2(u + \\alpha \\, v, u + \\alpha \\, v) = \\E_2(u, u) + 2\\alpha \\, \\E_2(u, v) + \\alpha^2 \\, \\E_2(v, v),\n\\]\nSince \\(u, v \\in \\ker\\E_2\\), the first and the last term vanish, and the above identity reduces to\n\\[\n\\E_2(w, w) = 2\\alpha \\, \\E_2(u, v)\n\\]\nThe bilinear form \\(\\E_2\\) is positive, therefore the left-hand side is positive, for all values of \\(\\alpha \\in \\reals\\). The quantity \\(\\E_2(u, v) = 0\\) is necessarily null, and \\(\\E_2(w, w) = 0\\), which proves that \\(w \\in V\\) and that \\(V\\) is a vector subspace of \\(U\\). The following characterization of \\(V\\) holds\n\\[\nv \\in V \\quad \\iff \\quad \\E_2(v, \\hat{u}) = 0 \\quad \\text{for all} \\quad \\hat{u} \\in U.\n\\tag{5.1}\\]\nIndeed, if for all \\(\\hat{u} \\in U\\), \\(\\E_2(v, \\hat{u}) = 0\\), then in particular \\(\\E_2(v, v) = 0\\) and \\(v \\in V\\). Conversely, let \\(v \\in V\\), \\(\\hat{u} \\in U\\) and \\(\\alpha \\in \\reals\\). Similarly to the previous proof, we write that \\(\\E_2(w, w) \\geq 0\\), with \\(w = \\hat{u} + \\alpha \\, v\\)\n\\[\n\\E_2(w, w) = \\E_2(\\hat{u}, \\hat{u}) + 2\\alpha \\, \\E_2(\\hat{u}, v) + \\alpha^2 \\, \\E_2(v, v) = 2\\alpha \\, \\E_2(\\hat{u}, v) + \\E_2(\\hat{u}, \\hat{u}) \\geq 0,\n\\]\n(\\(\\E_2(v, v) = 0\\) since \\(v \\in V\\)). The above expression is of degree 1 in \\(\\alpha\\), with a constant sign. Therefore the linear term in \\(\\alpha\\) must vanish: \\(\\E_2(\\hat{u}, v) = 0\\), which proves the characterization (5.1) of \\(V\\).\nIt will be assumed in the remainder of these notes the dimension of \\(V\\) is finite: \\(m = \\dim V < +\\infty\\); \\(m\\) is the multiplicity of the critical point. A (finite) basis \\((v_1, \\ldots, v_m)\\) of \\(V\\) can therefore be introduced, that is orthonormal in the sense of \\(\\langle \\bullet, \\bullet \\rangle\\)\n\\[\n\\langle v_i, v_j \\rangle = \\delta_{ij} \\quad \\text{for all} \\quad i, j = 1, \\ldots, m.\n\\]\nTo close this section, we define the complementary subspace \\(W\\), orthogonal to \\(V\\) for the scalar product \\(\\langle \\bullet, \\bullet \\rangle\\)\n\\[\nU = V \\overset{\\perp}{\\otimes} W \\quad \\text{and} \\quad \\langle \\hat{v}, \\hat{w} \\rangle = 0 \\quad \\text{for all} \\quad \\hat{v} \\in V \\quad \\text{and} \\quad \\hat{w} \\in W.\n\\]\n\n\n\n\n\n\nNote\n\n\n\nThe bilinear form \\(\\E_2\\) is elliptic over \\(W\\). Therefore, variational problems of the type: find \\(w \\in W\\) such that\n\\[\n\\E_2(w, \\hat{w})+\\ell(\\hat{w}) = 0 \\quad \\text{for all} \\quad \\hat{w} \\in W\n\\]\nare well-posed for any linear form \\(\\ell\\) over \\(W\\). In particular, for \\(\\ell=0\\), the unique solution to the variational problem\n\\[\n\\E_2(w, \\hat{w}) = 0 \\quad \\text{for all} \\quad \\hat{w} \\in W\n\\]\nis \\(w = 0\\)."
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Chakrabarti, Aditi, Serge Mora, Franck Richard, Ty Phou, Jean-Marc\nFromental, Yves Pomeau, and Basile Audoly. 2018. “Selection of\nHexagonal Buckling Patterns by the Elastic Rayleigh-Taylor\nInstability.” Journal of the Mechanics and Physics of\nSolids 121 (December): 234–57. https://doi.org/10.1016/j.jmps.2018.07.024.\n\n\nKoiter, W. T., and A. M. A. van der Heijden. 2009. W.T.\nKoiter’s Elastic Stability of Solids and Structures.\nCambridge ; New York: Cambridge University\nPress.\n\n\nKoiter, Warner Tjardus. 1945. “The Stability of\nElastic Equilibrium.” PhD thesis,\nDelft: Technische Hooge School Delft.\n\n\nNguyen, Quoc-Son. 2000. Stabilité et mécanique non\nlinéaire. Paris: Hermès Science\nPublications.\n\n\nPotier-Ferry, Michel. 1987. “Foundations of Elastic Postbuckling\nTheory.” In Buckling and Post-Buckling,\n1–82. Lecture Notes in Physics.\nSpringer, Berlin, Heidelberg. https://doi.org/10.1007/BFb0009197.\n\n\nTriantafyllidis, Nicolas. 2017. “Stability of Solids: From\nStructures to Materials.” Lecture Notes. Palaiseau,\nFrance: École polytechnique."
  },
  {
    "objectID": "perfect_system-sympy.html#initialization",
    "href": "perfect_system-sympy.html#initialization",
    "title": "Appendix A — Bifurcation equations of the perfect system",
    "section": "A.1 Initialization",
    "text": "A.1 Initialization\nWe define a few common symbols and useful functions.\n\nfrom lsk import *\n\n\n  \nzero = sp.Integer(0)\n\nλ, u, v, u_hat, v_hat, w_hat = sp.symbols(r\"\\lambda u v \\hat{u} \\hat{v} \\hat{w}\")"
  },
  {
    "objectID": "perfect_system-sympy.html#sec-20230103084732",
    "href": "perfect_system-sympy.html#sec-20230103084732",
    "title": "Appendix A — Bifurcation equations of the perfect system",
    "section": "A.2 Symbolic expressions of the energy and fundamental path",
    "text": "A.2 Symbolic expressions of the energy and fundamental path\nThe following developments involve the energy \\((u, \\lambda) \\mapsto \\E(u, \\lambda)\\) and its differentials at the critical point \\((u_0, \\lambda_0)\\), as well as the fundamental path \\(\\lambda \\mapsto u^\\ast(\\lambda)\\) and its derivatives at \\(\\lambda = \\lambda_0\\). It will therefore be convenient to express \\(\\E\\) and \\(u^\\star\\) as Taylor expansions with respect to \\(u\\) and \\(\\lambda\\).\nWe start with the Taylor expansion of the energy \\(\\E\\). We define its differentials at the critical point. These differentials are stored in a dictionary. Values are indexed with the order of the differentials with respect to \\(u\\) and \\(\\lambda\\).\n\n\n\n\n\n\nNote\n\n\n\nIn the following code blocks, n is the total order of the differential, p is the order of the differential with respect to \\(u\\) and q = n - p is the order of the differential with respect to \\(\\lambda\\).\n\n\n\ndE = dict()\nfor n in range(1, 5):\n    for p in range(n + 1):\n        q = n - p\n        if q == 0:\n            dE[p, q] = sp.Symbol(r\"\\E_{}\".format(p))\n        else:\n            dE[p, q] = sp.Symbol(r\"\\E_{\" + p * \"u\" + q * \"\\lambda\" + \"}\")\n            \n# Remember that the energy is stationary at the critical point (equilibrium)\ndE[1, 0] = zero\n\nThe dictionary dE should be understood as follows: dE[(2, 1)] == dE[2, 1] is the symbol \\(\\E_{uu\\lambda}\\), which stands for \\(\\E_{,uu\\lambda}(u_0, \\lambda_0; \\bullet, \\bullet)\\). The following symbols have been defined.\n\n\nCode\n_dict = dict()\nfor n in range(1, 5):\n    for p in range(n + 1):\n        q = n - p\n        _dict[dE[p, q]] = (\"\\\\E_{,\" + p * \"u\" \n                           + q * \"\\\\lambda\"\n                           + \"}(u_0, \\lambda_0)\")\n        \ndisplay_latex_dict(_dict, num_cols=3)\n\n\n\\(\\displaystyle \\begin{align}\\E_{\\lambda}&=\\E_{,\\lambda}(u_0, \\lambda_0)&0&=\\E_{,u}(u_0, \\lambda_0)&\\E_{\\lambda\\lambda}&=\\E_{,\\lambda\\lambda}(u_0, \\lambda_0)\\\\\\E_{u\\lambda}&=\\E_{,u\\lambda}(u_0, \\lambda_0)&\\E_{2}&=\\E_{,uu}(u_0, \\lambda_0)&\\E_{\\lambda\\lambda\\lambda}&=\\E_{,\\lambda\\lambda\\lambda}(u_0, \\lambda_0)\\\\\\E_{u\\lambda\\lambda}&=\\E_{,u\\lambda\\lambda}(u_0, \\lambda_0)&\\E_{uu\\lambda}&=\\E_{,uu\\lambda}(u_0, \\lambda_0)&\\E_{3}&=\\E_{,uuu}(u_0, \\lambda_0)\\\\\\E_{\\lambda\\lambda\\lambda\\lambda}&=\\E_{,\\lambda\\lambda\\lambda\\lambda}(u_0, \\lambda_0)&\\E_{u\\lambda\\lambda\\lambda}&=\\E_{,u\\lambda\\lambda\\lambda}(u_0, \\lambda_0)&\\E_{uu\\lambda\\lambda}&=\\E_{,uu\\lambda\\lambda}(u_0, \\lambda_0)\\\\\\E_{uuu\\lambda}&=\\E_{,uuu\\lambda}(u_0, \\lambda_0)&\\E_{4}&=\\E_{,uuuu}(u_0, \\lambda_0)&\\end{align}\\)\n\n\nwhere\n\n\\(\\E_\\lambda\\), \\(\\E_{\\lambda\\lambda}\\), \\(\\E_{\\lambda\\lambda\\lambda}\\) and \\(\\E_{\\lambda\\lambda\\lambda\\lambda}\\) are scalar quantities,\n\\(\\E_{u\\lambda}\\), \\(\\E_{u\\lambda\\lambda}\\) and \\(\\E_{u\\lambda\\lambda\\lambda}\\) are linear forms,\n\\(\\E_2\\), \\(\\E_{uu\\lambda}\\) and \\(\\E_{uu\\lambda\\lambda}\\) are bilinear forms,\n\\(\\E_3\\) and \\(\\E_{uuu\\lambda}\\) are trilinear forms,\n\\(\\E_4\\) is a quadrilinear form.\n\n\n\n\n\n\n\nImportant\n\n\n\nNote that all these differentials are defined as SymPy scalars. A definition as a SymPy function (e.g. E2 = Function(r\"\\E_2\")) would be more appropriate. However, SymPy would fail to account for multilinearity or symmetry of these forms. Therefore, we use the following trick: all multi-linear forms are defined as scalars, and the standard multiplication operator * means function application. In other words, E2 * (α * u + β * v) * w (resp. E2 * u * v - E2 * v * u) should be understood as E2(α * u + β * v, w) (resp. E2(u, v) - E2(v, u)). In both cases, the expressions would are correctly simplified.\nWhether the symbols in an expression are true scalars or vectors (elements of \\(U\\)) should be clear from the context. For example, in the expression: λ * E2 * u * v, the first * is a true multiplication, while the other * refer to function application.\n\n\nThe energy \\(\\E(u, \\lambda)\\) is now expressed as a Taylor expansion about the critical point.\n\n_f = lambda p, q: sp.binomial(p + q, p) / sp.factorial(p + q)\nE = sum(_f(p, q) * dE_pq * u**p * λ**q for (p, q), dE_pq in dE.items())\n\n\n\nCode\ndisplay_latex_equation(r\"\\E(u, \\lambda)\", E)\n\n\n\\(\\displaystyle \\E(u, \\lambda)=\\frac{\\E_{2} u^{2}}{2} + \\frac{\\E_{3} u^{3}}{6} + \\frac{\\E_{4} u^{4}}{24} + \\frac{\\E_{\\lambda\\lambda\\lambda\\lambda} \\lambda^{4}}{24} + \\frac{\\E_{\\lambda\\lambda\\lambda} \\lambda^{3}}{6} + \\frac{\\E_{\\lambda\\lambda} \\lambda^{2}}{2} + \\E_{\\lambda} \\lambda + \\frac{\\E_{u\\lambda\\lambda\\lambda} \\lambda^{3} u}{6} + \\frac{\\E_{u\\lambda\\lambda} \\lambda^{2} u}{2} + \\E_{u\\lambda} \\lambda u + \\frac{\\E_{uu\\lambda\\lambda} \\lambda^{2} u^{2}}{4} + \\frac{\\E_{uu\\lambda} \\lambda u^{2}}{2} + \\frac{\\E_{uuu\\lambda} \\lambda u^{3}}{6}\\)\n\n\nWe now turn to the definition of the fundamental path \\(\\lambda \\mapsto u^\\star(\\lambda)\\). We first define in a dictionary the derivatives of \\(u^\\star\\) with respect to \\(\\lambda\\), at \\(\\lambda = \\lambda_0 = 0\\). For example, du_0[2] is the symbol \\(\\ddot{u}_0\\), which stands for \\(\\D^2 u^\\star / \\D \\lambda^2 \\rvert_{\\lambda=\\lambda_0}\\).\n\ndu_0 = {n: sp.Symbol(\"\\\\\" + \"\".join(n * (\"d\",)) + \"ot{u}_0\") for n in range(1, 5)}\n\n_dict = {f\"\\\\frac{{\\\\D^{k}u^\\\\ast}}{{\\\\D \\\\lambda^{k}}}\" : v for k, v in du_0.items()}\n\n\n\nCode\ndisplay_latex_dict(_dict, num_cols=4)\n\n\n\\(\\displaystyle \\begin{align}\\frac{\\D^1u^\\ast}{\\D \\lambda^1}&=\\dot{u}_0&\\frac{\\D^2u^\\ast}{\\D \\lambda^2}&=\\ddot{u}_0&\\frac{\\D^3u^\\ast}{\\D \\lambda^3}&=\\dddot{u}_0&\\frac{\\D^4u^\\ast}{\\D \\lambda^4}&=\\ddddot{u}_0\\\\\\end{align}\\)\n\n\nThe fundamental path is then defined through its Taylor expansion.\n\nu_star = sum(λ**n / sp.factorial(n) * v for n, v in du_0.items())\n\n\n\nCode\ndisplay_latex_equation(r\"u^\\star(\\lambda)\", u_star)\n\n\n\\(\\displaystyle u^\\star(\\lambda)=\\frac{\\ddddot{u}_0 \\lambda^{4}}{24} + \\frac{\\dddot{u}_0 \\lambda^{3}}{6} + \\frac{\\ddot{u}_0 \\lambda^{2}}{2} + \\dot{u}_0 \\lambda\\)\n\n\nIt will be assumed in the following that \\(v, \\hat{v} \\in V\\), therefore terms of the form \\(\\E_2(\\bullet, v)\\) and \\(\\E_2(\\bullet, \\hat{v})\\) should vanish. The following function performs this simplification.\n\n# Let's define a convenient alias to the Hessian\nE2 = dE[2, 0]\n\ndef simplify_E2(expr):\n    expr = expr.expand()\n    coeff_E2 = expr.coeff(E2).expand()\n    coeff_E2_v = coeff_E2.coeff(v)\n    coeff_E2_v_hat = (coeff_E2 - coeff_E2_v * v).expand().coeff(v_hat)\n    return (expr - (coeff_E2_v * E2 * v + coeff_E2_v_hat * E2 * v_hat)).expand()\n\nassert simplify_E2(E2 * v) == 0\nassert simplify_E2(E2 * v_hat) == 0\nassert simplify_E2(3 * v + 4 * v_hat + 5 * v * v_hat + 6 * E2 * v + 7 * E2 * v_hat + 8 * E2 * v * v_hat) == 3 * v + 4 * v_hat + 5 * v * v_hat"
  },
  {
    "objectID": "perfect_system-sympy.html#elimination-of-the-mixed-derivatives-of-the-energy",
    "href": "perfect_system-sympy.html#elimination-of-the-mixed-derivatives-of-the-energy",
    "title": "Appendix A — Bifurcation equations of the perfect system",
    "section": "A.2 Elimination of the mixed derivatives of the energy",
    "text": "A.2 Elimination of the mixed derivatives of the energy\nSince the fundamental path \\(\\lambda \\mapsto u^\\ast(\\lambda)\\) is an equilibrium path, the various differentials of the energy at the critical point are not linearly independent. To express the relationships between these forms, we define \\(\\mathcal R^\\ast(\\lambda; \\bullet)\\) as the jacobian of the energy along the fundamental path \\(u^\\ast(\\lambda)\\)\n\\[\n\\mathcal R^\\ast(\\lambda; \\bullet) = \\E_{,u}[u^\\ast(\\lambda), \\lambda; \\bullet].\n\\]\n\nR_star = (E.diff(u) * u_hat).subs(u, u_star).expand()\n\n\n\nCode\ndisplay_latex_equation(r\"\\mathcal{R}^\\ast(\\lambda;\" + sp.latex(u_hat) + \")\",\n                       R_star.series(λ, 0, 5))\n\n\n\\(\\displaystyle \\mathcal{R}^\\ast(\\lambda;\\hat{u})=\\lambda \\left(\\E_{2} \\dot{u}_0 \\hat{u} + \\E_{u\\lambda} \\hat{u}\\right) + \\lambda^{2} \\left(\\frac{\\E_{2} \\ddot{u}_0 \\hat{u}}{2} + \\frac{\\E_{3} \\dot{u}_0^{2} \\hat{u}}{2} + \\frac{\\E_{u\\lambda\\lambda} \\hat{u}}{2} + \\E_{uu\\lambda} \\dot{u}_0 \\hat{u}\\right) + \\lambda^{3} \\left(\\frac{\\E_{2} \\dddot{u}_0 \\hat{u}}{6} + \\frac{\\E_{3} \\ddot{u}_0 \\dot{u}_0 \\hat{u}}{2} + \\frac{\\E_{4} \\dot{u}_0^{3} \\hat{u}}{6} + \\frac{\\E_{u\\lambda\\lambda\\lambda} \\hat{u}}{6} + \\frac{\\E_{uu\\lambda\\lambda} \\dot{u}_0 \\hat{u}}{2} + \\frac{\\E_{uu\\lambda} \\ddot{u}_0 \\hat{u}}{2} + \\frac{\\E_{uuu\\lambda} \\dot{u}_0^{2} \\hat{u}}{2}\\right) + \\lambda^{4} \\left(\\frac{\\E_{2} \\ddddot{u}_0 \\hat{u}}{24} + \\frac{\\E_{3} \\dddot{u}_0 \\dot{u}_0 \\hat{u}}{6} + \\frac{\\E_{3} \\ddot{u}_0^{2} \\hat{u}}{8} + \\frac{\\E_{4} \\ddot{u}_0 \\dot{u}_0^{2} \\hat{u}}{4} + \\frac{\\E_{uu\\lambda\\lambda} \\ddot{u}_0 \\hat{u}}{4} + \\frac{\\E_{uu\\lambda} \\dddot{u}_0 \\hat{u}}{6} + \\frac{\\E_{uuu\\lambda} \\ddot{u}_0 \\dot{u}_0 \\hat{u}}{2}\\right) + O\\left(\\lambda^{5}\\right)\\)\n\n\nOf course, since \\(\\lambda \\mapsto u^\\ast(\\lambda)\\) is an equilibrium path, we have \\(\\mathcal R^\\ast(\\lambda; \\bullet) = 0\\) for all \\(\\lambda\\). Therefore, all coefficients of the above polynomial in \\(\\lambda\\) are null, which delivers expressions of \\(\\E_{u\\lambda}\\), \\(\\E_{u\\lambda\\lambda}\\) and \\(\\E_{u\\lambda\\lambda\\lambda}\\)\n\nmixed1 = dict()\n\nfor q in range(1, 4):\n    x = dE[1, q]\n    eq = R_star.coeff(λ, q)\n    sol = sp.solve(eq, x)[0]\n    mixed1[x] = sol\n\n\n\nCode\ndisplay_latex_dict(mixed1, num_cols=1)\n\n\n\\(\\displaystyle \\begin{align}\\E_{u\\lambda}&=- \\E_{2} \\dot{u}_0\\\\\\E_{u\\lambda\\lambda}&=- \\E_{2} \\ddot{u}_0 - \\E_{3} \\dot{u}_0^{2} - 2 \\E_{uu\\lambda} \\dot{u}_0\\\\\\E_{u\\lambda\\lambda\\lambda}&=- \\E_{2} \\dddot{u}_0 - 3 \\E_{3} \\ddot{u}_0 \\dot{u}_0 - \\E_{4} \\dot{u}_0^{3} - 3 \\E_{uu\\lambda\\lambda} \\dot{u}_0 - 3 \\E_{uu\\lambda} \\ddot{u}_0 - 3 \\E_{uuu\\lambda} \\dot{u}_0^{2}\\\\\\end{align}\\)\n\n\nWe want to get rid of the remaining mixed derivatives, namely: \\(\\E_{uu\\lambda}\\), \\(\\E_{uuu\\lambda}\\) and \\(\\E_{uu\\lambda\\lambda}\\). To do so, we introduce the derivatives \\(\\dot{\\E}_2\\), \\(\\ddot{\\E}_2\\) and \\(\\dot{\\E}_3\\) defined in Chapter 2.\n\nE2_dot, E2_ddot, E3_dot = sp.symbols(\"\\dot{\\E}_2 \\ddot{\\E}_2 \\dot{\\E}_3\")\n\nE_uu_star = E.diff(u, 2).subs(u, u_star).expand()\nE_uuu_star = E.diff(u, 3).subs(u, u_star).expand()\n\neqs = [sp.Eq(E2_dot, E_uu_star.coeff(λ, 1)),\n       sp.Eq(E3_dot, E_uuu_star.coeff(λ, 1)),\n       sp.Eq(E2_ddot, 2 * E_uu_star.coeff(λ, 2))]\n\nunknowns = [dE[2, 1], dE[3, 1], dE[2, 2]] # E_uuλ, E_uuuλ, E_uuλλ\n\nmixed2 = dict()\nfor eq, x in zip(eqs, unknowns):\n    mixed2[x] = sp.solve(eq, x)[0].subs(mixed2).expand()\n\nWe get the following expressions\n\n\nCode\ndisplay_latex_dict(mixed2, num_cols=1)\n\n\n\\(\\displaystyle \\begin{align}\\E_{uu\\lambda}&=- \\E_{3} \\dot{u}_0 + \\dot{\\E}_2\\\\\\E_{uuu\\lambda}&=- \\E_{4} \\dot{u}_0 + \\dot{\\E}_3\\\\\\E_{uu\\lambda\\lambda}&=- \\E_{3} \\ddot{u}_0 + \\E_{4} \\dot{u}_0^{2} + \\ddot{\\E}_2 - 2 \\dot{\\E}_3 \\dot{u}_0\\\\\\end{align}\\)\n\n\nCombining the above results allows to fully eliminate the mixed derivatives\n\n\nCode\nmixed = {k: v.subs(mixed2).expand() for k, v in mixed1.items()}\nmixed.update(mixed2)\n\ndisplay_latex_dict(mixed, num_cols=1)\n\n\n\\(\\displaystyle \\begin{align}\\E_{u\\lambda}&=- \\E_{2} \\dot{u}_0\\\\\\E_{u\\lambda\\lambda}&=- \\E_{2} \\ddot{u}_0 + \\E_{3} \\dot{u}_0^{2} - 2 \\dot{\\E}_2 \\dot{u}_0\\\\\\E_{u\\lambda\\lambda\\lambda}&=- \\E_{2} \\dddot{u}_0 + 3 \\E_{3} \\ddot{u}_0 \\dot{u}_0 - \\E_{4} \\dot{u}_0^{3} - 3 \\ddot{\\E}_2 \\dot{u}_0 - 3 \\ddot{u}_0 \\dot{\\E}_2 + 3 \\dot{\\E}_3 \\dot{u}_0^{2}\\\\\\E_{uu\\lambda}&=- \\E_{3} \\dot{u}_0 + \\dot{\\E}_2\\\\\\E_{uuu\\lambda}&=- \\E_{4} \\dot{u}_0 + \\dot{\\E}_3\\\\\\E_{uu\\lambda\\lambda}&=- \\E_{3} \\ddot{u}_0 + \\E_{4} \\dot{u}_0^{2} + \\ddot{\\E}_2 - 2 \\dot{\\E}_3 \\dot{u}_0\\\\\\end{align}\\)\n\n\nThese expressions can be plugged into the expansion of the energy.\n\nE = E.subs(mixed).expand()\n\n\n\nCode\ndisplay_latex_equation(r\"\\E(u, \\lambda)\", E)\n\n\n\\(\\displaystyle \\E(u, \\lambda)=- \\frac{\\E_{2} \\dddot{u}_0 \\lambda^{3} u}{6} - \\frac{\\E_{2} \\ddot{u}_0 \\lambda^{2} u}{2} - \\E_{2} \\dot{u}_0 \\lambda u + \\frac{\\E_{2} u^{2}}{2} + \\frac{\\E_{3} \\ddot{u}_0 \\dot{u}_0 \\lambda^{3} u}{2} - \\frac{\\E_{3} \\ddot{u}_0 \\lambda^{2} u^{2}}{4} + \\frac{\\E_{3} \\dot{u}_0^{2} \\lambda^{2} u}{2} - \\frac{\\E_{3} \\dot{u}_0 \\lambda u^{2}}{2} + \\frac{\\E_{3} u^{3}}{6} - \\frac{\\E_{4} \\dot{u}_0^{3} \\lambda^{3} u}{6} + \\frac{\\E_{4} \\dot{u}_0^{2} \\lambda^{2} u^{2}}{4} - \\frac{\\E_{4} \\dot{u}_0 \\lambda u^{3}}{6} + \\frac{\\E_{4} u^{4}}{24} + \\frac{\\E_{\\lambda\\lambda\\lambda\\lambda} \\lambda^{4}}{24} + \\frac{\\E_{\\lambda\\lambda\\lambda} \\lambda^{3}}{6} + \\frac{\\E_{\\lambda\\lambda} \\lambda^{2}}{2} + \\E_{\\lambda} \\lambda - \\frac{\\ddot{\\E}_2 \\dot{u}_0 \\lambda^{3} u}{2} + \\frac{\\ddot{\\E}_2 \\lambda^{2} u^{2}}{4} - \\frac{\\ddot{u}_0 \\dot{\\E}_2 \\lambda^{3} u}{2} - \\dot{\\E}_2 \\dot{u}_0 \\lambda^{2} u + \\frac{\\dot{\\E}_2 \\lambda u^{2}}{2} + \\frac{\\dot{\\E}_3 \\dot{u}_0^{2} \\lambda^{3} u}{2} - \\frac{\\dot{\\E}_3 \\dot{u}_0 \\lambda^{2} u^{2}}{2} + \\frac{\\dot{\\E}_3 \\lambda u^{3}}{6}\\)"
  },
  {
    "objectID": "perfect_system-sympy.html#derivation-of-the-bifurcation-equations",
    "href": "perfect_system-sympy.html#derivation-of-the-bifurcation-equations",
    "title": "Appendix A — Bifurcation equations of the perfect system",
    "section": "A.2 Derivation of the bifurcation equations",
    "text": "A.2 Derivation of the bifurcation equations\nIn this section, we show that, besides the fundamental branch \\(u^\\ast(\\lambda)\\), other (bifurcated) equilibrium branches may pass through the critical point \\((u_0, \\lambda_0)\\). The starting point is the characterization of an equilibrium by the stationarity of the energy, which defines all equilibrium branches as implicit functions, which can be expanded with respect to some perturbation parameter.\nThe approach adopted here relies on the Lyapunov–Schmidt decomposition of the equilibrium branch over \\(V\\) and \\(W\\). Other approaches are possible, see e.g. Chakrabarti et al. (2018).\nFor a given value of \\(\\lambda\\) (close to the critical value \\(\\lambda_0\\)), We seek an equilibrium point \\(u\\) of the system, such that\n\\[\n\\E_{,u}(u, \\lambda; \\hat{u}) = 0 \\quad \\text{for all} \\quad \\hat{u} \\in U.\n\\tag{A.1}\\]\n\nres = (E.diff(u) * u_hat).expand()\n\nThe above equation reads: for all \\(\\hat{u} \\in U\\)\n\n\nCode\ndisplay_latex_equation(res, 0)\n\n\n\\(\\displaystyle - \\frac{\\E_{2} \\dddot{u}_0 \\hat{u} \\lambda^{3}}{6} - \\frac{\\E_{2} \\ddot{u}_0 \\hat{u} \\lambda^{2}}{2} - \\E_{2} \\dot{u}_0 \\hat{u} \\lambda + \\E_{2} \\hat{u} u + \\frac{\\E_{3} \\ddot{u}_0 \\dot{u}_0 \\hat{u} \\lambda^{3}}{2} - \\frac{\\E_{3} \\ddot{u}_0 \\hat{u} \\lambda^{2} u}{2} + \\frac{\\E_{3} \\dot{u}_0^{2} \\hat{u} \\lambda^{2}}{2} - \\E_{3} \\dot{u}_0 \\hat{u} \\lambda u + \\frac{\\E_{3} \\hat{u} u^{2}}{2} - \\frac{\\E_{4} \\dot{u}_0^{3} \\hat{u} \\lambda^{3}}{6} + \\frac{\\E_{4} \\dot{u}_0^{2} \\hat{u} \\lambda^{2} u}{2} - \\frac{\\E_{4} \\dot{u}_0 \\hat{u} \\lambda u^{2}}{2} + \\frac{\\E_{4} \\hat{u} u^{3}}{6} - \\frac{\\ddot{\\E}_2 \\dot{u}_0 \\hat{u} \\lambda^{3}}{2} + \\frac{\\ddot{\\E}_2 \\hat{u} \\lambda^{2} u}{2} - \\frac{\\ddot{u}_0 \\dot{\\E}_2 \\hat{u} \\lambda^{3}}{2} - \\dot{\\E}_2 \\dot{u}_0 \\hat{u} \\lambda^{2} + \\dot{\\E}_2 \\hat{u} \\lambda u + \\frac{\\dot{\\E}_3 \\dot{u}_0^{2} \\hat{u} \\lambda^{3}}{2} - \\dot{\\E}_3 \\dot{u}_0 \\hat{u} \\lambda^{2} u + \\frac{\\dot{\\E}_3 \\hat{u} \\lambda u^{2}}{2}=0\\)\n\n\nThe equilibrium state \\(u\\) is projected onto the orthogonal subspaces \\(V\\) and \\(W\\).\n\\[\nu = u^\\ast(\\lambda) + \\xi_i \\, v_i + w, \\quad \\text{with} \\quad w \\in W.\n\\tag{A.2}\\]\nIt follows from the orthogonality of \\(V\\) and \\(W\\) that \\(\\langle v_i, w \\rangle = 0\\) for all \\(i=1, \\ldots, m\\). Analysis of the bifurcated branches therefore reduces to finding \\(\\xi_1, \\ldots, \\xi_m \\in \\reals\\) and \\(w \\in W\\), such that\n\\[\n\\E_{,u}[u^\\ast(\\lambda) + \\xi_i \\, v_i + w, \\lambda; \\hat{u}] = 0 \\quad \\text{for all} \\quad \\hat{u} \\in U.\n\\tag{A.3}\\]\nThe method proceeds in three steps\n\nEq. (A.3) is first expressed for \\(\\hat{u} \\in W\\) which leads to a definition of \\(w\\) as an implicit function of \\(\\xi_1, \\ldots, \\xi_m\\) and \\(\\lambda\\) (see Section A.2.1),\nEq. (A.3) is then expressed for \\(\\hat{u} \\in V\\) which leads to a definition of \\(\\lambda\\) as an implicit function of \\(\\xi_1, \\ldots, \\xi_m\\) (see Section A.2.2),\nfinally, a parametrization \\(\\eta\\) of \\(\\xi_1\\), \\(\\xi_m\\) is introduced and the Taylor expansion of \\(u\\) and \\(\\lambda\\) with respect to \\(\\eta\\) is derived (see ?sec-20230102030224).\n\n\nA.2.1 Elimination of \\(w\\)\nWe first test Eq. (A.1) with \\(\\hat{w} \\in W\\)\n\\[\n\\E_{,u}[u^\\ast(\\lambda) + \\xi_i \\, v_i + w, \\lambda; \\hat{w}] = 0, \\quad \\text{for all} \\quad \\hat{w} \\in W.\n\\tag{A.4}\\]\nThis defines \\(w\\) as an implicit function of \\(\\xi_1, \\ldots, \\xi_m\\) and \\(\\lambda\\). The following asymptotic expansion about \\(\\xi_1 = \\cdots = \\xi_m = 0\\) and \\(\\lambda = \\lambda_0\\) is postulated\n\\[\n\\begin{aligned}\nw(\\xi_1, \\ldots, \\xi_m, \\lambda) ={} & \\xi_i \\, w_i + \\bigl( \\lambda - \\lambda_0 \\bigr) \\, w_\\lambda\\\\\n&+ \\tfrac{1}{2} \\xi_i \\, \\xi_j \\, w_{ij} + \\tfrac{1}{2} \\bigl( \\lambda - \\lambda_0 \\bigr)^2 w_{\\lambda\\lambda} + \\xi_i \\, \\bigl( \\lambda - \\lambda_0 \\bigr) w_{i\\lambda} + \\cdots,\n\\end{aligned}\n\\tag{A.5}\\]\nwhere \\(w_i\\), \\(w_\\lambda\\), \\(w_{ij}\\), \\(w_{\\lambda\\lambda}\\) and \\(w_{i\\lambda}\\) are elements of \\(W\\) to be defined.\n\n\n\n\n\n\nImportant\n\n\n\nIndicial expressions are somewhat difficult to handle in SymPy, we therefore use a “trick”\n\nξ stands for \\(\\xi_i\\),\nw_ξ stands for \\(w_i\\),\nw_ξξstands for \\(w_{ij}\\),\nw_ξλ stands for \\(w_{i\\lambda}\\).\n\nThen expressions such as ξ * w_ξ (resp. ξ^2 * w_ξξ) should be understood as \\(\\xi_i \\, w_i\\) (resp. \\(\\xi_i \\, \\xi_j \\, w_{ij}\\)).\n\n\n\nξ, w_ξ, w_λ, w_ξξ, w_ξλ, w_λλ = sp.symbols(r\"\\xi w_\\xi w_\\lambda w_{\\xi\\xi} w_{\\xi\\lambda} w_{\\lambda\\lambda}\")\nw = ξ * w_ξ + λ * w_λ + (ξ**2 * w_ξξ + 2 * ξ * λ * w_ξλ + λ**2 * w_λλ) / 2\n\nIt will be useful to define the critical point\n\ncrit = {ξ: 0, λ: 0}\n\nEq. (A.5) is plugged into Eq. (A.4), which then delivers an asymptotic expansion of the stationarity equation. We will nullify the terms of order up to 2 in \\(\\xi_i\\) and \\(\\lambda\\).\n\nres_w = res.subs({u_hat: w_hat, u: u_star + ξ * v + w}).expand()\n\nWe can then nullify the various coefficients of this polynomial expansion, starting with the \\(\\xi_i\\) terms\n\neq = sp.Eq(simplify_E2(res_w.coeff(ξ)), 0).subs(crit)\ndisplay(eq)\n\n\\(\\displaystyle \\E_{2} \\hat{w} w_{\\xi} = 0\\)\n\n\nwhich should be understood as\n\\[\n\\E_2(w_i, \\hat{w}) = 0 \\quad \\text{for all} \\quad \\hat{w} \\in W.\n\\]\nAs argued in Chapter 4, this leads to \\(w_i = 0\\). We now consider the \\(\\lambda\\) term\n\neq = sp.Eq(simplify_E2(res_w.coeff(λ)), 0).subs(crit)\ndisplay(eq)\n\n\\(\\displaystyle \\E_{2} \\hat{w} w_{\\lambda} = 0\\)\n\n\nWhich sould be understood as\n\\[\n\\E_2(w_\\lambda, \\hat{w}) = 0 \\quad \\text{for all} \\quad \\hat{w} \\in W.\n\\]\nThis again leads to \\(w_\\lambda = 0\\). The \\(\\lambda^2\\) term again delivers then vanishes automatically.\n\\[\n\\E_2(w_{\\lambda\\lambda}, \\hat{w}) = 0 \\quad \\text{for all} \\quad \\hat{w} \\in W,\n\\]\nfrom which it results that \\(w_{\\lambda\\lambda} = 0\\)\n\nassert 2 * res_w.coeff(λ, 2).subs(crit).subs(w_λ, 0).expand() == E2 * w_λλ * w_hat\n\nThe \\(\\xi_i \\, \\xi_j\\) terms deliver the following equations\n\n(eq_w_ξξ := sp.Eq(2 * res_w.coeff(ξ, 2), 0).subs(crit).subs(w_ξ, 0).expand())\n\n\\(\\displaystyle \\E_{2} \\hat{w} w_{\\xi\\xi} + \\E_{3} \\hat{w} v^{2} = 0\\)\n\n\nThe above equation should be understood as the following variational problem: find \\(w_{ij} \\in W\\) such that\n\\[\n\\E_2(w_{ij}, \\hat{w}) + \\E_3(v_i, v_j, \\hat{w}) = 0 \\quad \\text{for all} \\quad \\hat{w} \\in W,\n\\tag{A.6}\\]\nwhich defines uniquely the \\(w_{ij}\\). Finally, the \\(\\xi_i \\, \\lambda\\) terms deliver the following variational problem\n\n(eq_w_ξλ := sp.Eq(res_w.coeff(ξ).coeff(λ), 0).subs(crit).subs({w_ξ: 0, w_λ: 0}).expand())\n\n\\(\\displaystyle \\E_{2} \\hat{w} w_{\\xi\\lambda} + \\dot{\\E}_2 \\hat{w} v = 0\\)\n\n\nIn other words: find \\(w_{i\\lambda} \\in W\\) such that\n\\[\n\\E_2(w_{i\\lambda}, \\hat{w}) + \\dot{\\E}_2(v_i, \\hat{w}) = 0 \\quad \\text{for all} \\quad \\hat{w} \\in W,\n\\tag{A.7}\\]\nwhich again defines \\(w_{i\\lambda}\\) uniquely.\nAs a conclusion, it has been shown that \\(w_1 = \\cdots = w_m = w_\\lambda = w_{\\lambda\\lambda} = 0\\). The Taylor expansion of \\(w\\) therefore reduces to\n\\[\nw(\\xi_1, \\ldots, \\xi_m, \\lambda) = \\tfrac{1}{2} \\xi_i \\, \\xi_j \\, w_{ij} + \\xi_i \\, \\bigl( \\lambda - \\lambda_0 \\bigr) w_{i\\lambda} + \\cdots,\n\\]\nwhere \\(w_{ij}\\) and \\(w_{i\\lambda}\\) are the solutions to the variational problems (A.6) and (A.7), respectively.\n\n\nA.2.2 Elimination of \\(\\lambda\\)\nWe now test Eq. (A.1) with \\(\\hat{v} \\in V\\)\n\\[\n\\E_{,u}[u^\\ast(\\lambda) + \\xi_i \\, v_i + w(\\xi_1, \\ldots, \\xi_m, \\lambda), \\lambda; \\hat{v}] = 0, \\quad \\text{for all} \\quad \\hat{v} \\in W.\n\\tag{A.8}\\]\nThis now defines \\(\\lambda\\) as an implicit function of \\(\\xi_1, \\ldots, \\xi_m\\). The following asymptotic expansion about \\(\\xi_1 = \\cdots = \\xi_m = 0\\) is postulated\n\\[\n\\lambda(\\xi_1, \\ldots, \\xi_m) = \\xi_i \\, \\lambda_i + \\tfrac{1}{2} \\, \\xi_i \\, \\xi_j \\, \\lambda_{ij}\\\\\n\\tag{A.9}\\]\nwhere \\(\\lambda_i\\) and \\(\\lambda_{ij}\\) are scalar coefficients to be defined.\n\n\n\n\n\n\nImportant\n\n\n\nAs mentioned above, handling of indicial expressions is a bit awkward in SymPy. Therefore, we define well-formed products such as \\(\\lambda_i \\, \\xi_i\\) or \\(\\lambda_{ij} \\, \\xi_i \\, \\xi_j\\) as fully parenthesized symbols.\nThe auxiliary variable t records the order of each term with respect to the \\(\\xi_1, \\ldots, \\xi_m\\).\n\nt = sp.Symbol(\"t\")\n\n\n\nWe first introduce the asymptotic expansion, of \\((\\xi_1, \\ldots, \\xi_m, \\lambda) \\mapsto w(\\xi_1, \\ldots, \\xi_m, \\lambda)\\), \\((\\xi_1, \\ldots, \\xi_m) \\mapsto \\lambda(\\xi_1, \\ldots, \\xi_m)\\) and finally \\((\\xi_1, \\ldots, \\xi_m) \\mapsto u(\\xi_1, \\ldots, \\xi_m)\\) see Eqs. (A.5), (A.9) and (A.2).\n\nw_bif = (t * λ * sp.Symbol(r\"\\bigl(\\xi_k\\,w_{k\\lambda}\\bigr)\") \n         + t **2 / 2 * sp.Symbol(r\"\\bigl(\\xi_i\\,\\xi_j\\,w_{ij}\\bigr)\"))\n\nλ_bif = (t * sp.Symbol(r\"\\bigl(\\xi_{p}\\,\\lambda_{p}\\bigr)\")\n         + t**2 / 2 * sp.Symbol(r\"\\bigl(\\xi_m\\,\\xi_n\\,\\lambda_{mn}\\bigr)\"))\n\nu_bif = u_star + t * sp.Symbol(r\"\\bigl(\\xi_{l}\\,v_{l}\\bigr)\") + w_bif\n\n\n\nCode\ndisplay_latex_equation(r\"w(\\xi_1, \\ldots, \\xi_m, \\lambda)\", w_bif)\ndisplay_latex_equation(r\"\\lambda(\\xi_1, \\ldots, \\xi_m)\", λ_bif)\ndisplay_latex_equation(r\"u(\\xi_1, \\ldots, \\xi_m)\", u_bif)\n\n\n\\(\\displaystyle w(\\xi_1, \\ldots, \\xi_m, \\lambda)=\\frac{\\bigl(\\xi_i\\,\\xi_j\\,w_{ij}\\bigr) t^{2}}{2} + \\bigl(\\xi_k\\,w_{k\\lambda}\\bigr) \\lambda t\\)\n\n\n\\(\\displaystyle \\lambda(\\xi_1, \\ldots, \\xi_m)=\\frac{\\bigl(\\xi_m\\,\\xi_n\\,\\lambda_{mn}\\bigr) t^{2}}{2} + \\bigl(\\xi_{p}\\,\\lambda_{p}\\bigr) t\\)\n\n\n\\(\\displaystyle u(\\xi_1, \\ldots, \\xi_m)=\\frac{\\bigl(\\xi_i\\,\\xi_j\\,w_{ij}\\bigr) t^{2}}{2} + \\bigl(\\xi_k\\,w_{k\\lambda}\\bigr) \\lambda t + \\bigl(\\xi_{l}\\,v_{l}\\bigr) t + \\frac{\\ddddot{u}_0 \\lambda^{4}}{24} + \\frac{\\dddot{u}_0 \\lambda^{3}}{6} + \\frac{\\ddot{u}_0 \\lambda^{2}}{2} + \\dot{u}_0 \\lambda\\)\n\n\nThe above expansions are plugged in the general expression of \\(\\E_{,u}(u, \\lambda; \\bullet)\\) and tested with \\(\\hat{v} \\in V\\), see Eq. (A.8).\n\nres_v = res.subs(u_hat, v_hat).subs(u, u_bif).subs(λ, λ_bif).expand()\n\n\n\n\n\n\n\nNote\n\n\n\nWe used three consecutive subs() rather than one big dictionary substitution for better control on the order of the substitutions. Indeed, we must make sure λ_bif is also plugged into u_bif.\n\n\nWe get an asymptotic expansion of the residual with respect to \\(\\xi_1, \\ldots, \\xi_m\\). This residual must vanish for all \\(\\xi_i\\) sufficiently small. Therefore, all coefficients of the expansion res_v must be nullified at all orders and for all \\(\\xi_i\\) sufficiently small. Consiering the expansion up to third order, we get after simplification only two bifurcation equations, since the terms of order 0 and 1 are identically null.\n\ncoeffs = [simplify_E2(res_v.coeff(t, k)) for k in range(4)]\n    \nassert coeffs[0] == 0\nassert coeffs[1] == 0\n\n\n\nCode\nfor coeff in coeffs[2:]:\n    display_latex_equation(coeff, 0)\n\n\n\\(\\displaystyle \\frac{\\E_{3} \\bigl(\\xi_{l}\\,v_{l}\\bigr)^{2} \\hat{v}}{2} + \\bigl(\\xi_{l}\\,v_{l}\\bigr) \\bigl(\\xi_{p}\\,\\lambda_{p}\\bigr) \\dot{\\E}_2 \\hat{v}=0\\)\n\n\n\\(\\displaystyle \\frac{\\E_{3} \\bigl(\\xi_i\\,\\xi_j\\,w_{ij}\\bigr) \\bigl(\\xi_{l}\\,v_{l}\\bigr) \\hat{v}}{2} + \\E_{3} \\bigl(\\xi_k\\,w_{k\\lambda}\\bigr) \\bigl(\\xi_{l}\\,v_{l}\\bigr) \\bigl(\\xi_{p}\\,\\lambda_{p}\\bigr) \\hat{v} + \\frac{\\E_{4} \\bigl(\\xi_{l}\\,v_{l}\\bigr)^{3} \\hat{v}}{6} + \\frac{\\bigl(\\xi_i\\,\\xi_j\\,w_{ij}\\bigr) \\bigl(\\xi_{p}\\,\\lambda_{p}\\bigr) \\dot{\\E}_2 \\hat{v}}{2} + \\bigl(\\xi_k\\,w_{k\\lambda}\\bigr) \\bigl(\\xi_{p}\\,\\lambda_{p}\\bigr)^{2} \\dot{\\E}_2 \\hat{v} + \\frac{\\bigl(\\xi_m\\,\\xi_n\\,\\lambda_{mn}\\bigr) \\bigl(\\xi_{l}\\,v_{l}\\bigr) \\dot{\\E}_2 \\hat{v}}{2} + \\frac{\\bigl(\\xi_{l}\\,v_{l}\\bigr)^{2} \\bigl(\\xi_{p}\\,\\lambda_{p}\\bigr) \\dot{\\E}_3 \\hat{v}}{2} + \\frac{\\bigl(\\xi_{l}\\,v_{l}\\bigr) \\bigl(\\xi_{p}\\,\\lambda_{p}\\bigr)^{2} \\ddot{\\E}_2 \\hat{v}}{2}=0\\)\n\n\nThe above bifurcation equations should be understood as follows \\[\n\\xi_j \\, \\xi_k \\, \\bigl[\n\\tfrac{1}{2} \\E_3(v_j, v_k, \\hat{v})\n+ \\lambda_k \\, \\dot{\\E}_2(v_j, \\hat{v})\n\\bigr] = 0\n\\tag{A.10}\\] and \\[\n\\begin{aligned}[b]\n\\xi_j \\, \\xi_k \\, \\xi_l \\, \\bigl[\n\\tfrac{1}{2} \\E_3(v_j, w_{kl}, \\hat{v})\n+ \\lambda_l \\, \\E_3(v_j, w_{k\\lambda}, \\hat{v})\n+ \\tfrac{1}{6} \\E_4(v_j, v_k, v_l, \\hat{v}) &\\\\\n+ \\tfrac{1}{2} \\lambda_l \\, \\dot{\\E}_2(w_{jk}, \\hat{v})\n+ \\lambda_k \\, \\lambda_l \\, \\dot{\\E}_2(w_{j\\lambda}, \\hat{v})\n+ \\tfrac{1}{2} \\lambda_{kl} \\, \\dot{\\E}_2(v_j, \\hat{v}) &\\\\\n+ \\tfrac{1}{2} \\lambda_l \\, \\dot{\\E}_3(v_j, v_k, \\hat{v})\n+ \\tfrac{1}{2} \\lambda_k \\, \\lambda_l \\, \\ddot{\\E}_2(v_j, \\hat{v})\n\\bigr] &= 0.\n\\end{aligned}\n\\tag{A.11}\\]\nNote that these equations are in fact asymptotic expansions. As such, they should hold for all \\(\\xi_1, \\ldots, \\xi_m\\) sufficiently small. Since both equations are homogeneous in \\(\\xi_1, \\ldots, \\xi_m\\), it is equivalent to require these to hold for all \\(\\xi_1, \\ldots, \\xi_m \\in \\reals\\).\n\n\n\n\nChakrabarti, Aditi, Serge Mora, Franck Richard, Ty Phou, Jean-Marc Fromental, Yves Pomeau, and Basile Audoly. 2018. “Selection of Hexagonal Buckling Patterns by the Elastic Rayleigh-Taylor Instability.” Journal of the Mechanics and Physics of Solids 121 (December): 234–57. https://doi.org/10.1016/j.jmps.2018.07.024."
  },
  {
    "objectID": "technical_proofs.html#sec-20230124212008",
    "href": "technical_proofs.html#sec-20230124212008",
    "title": "Appendix A — Technical proofs",
    "section": "A.1 Proof of Eq. (5.5)",
    "text": "A.1 Proof of Eq. (5.5)\nWe first prove a preliminary identity. For fixed \\(i = 1, \\ldots, m\\), Eq. (5.2) is of the form \\(L_{jk} \\, \\xi_j \\, \\xi_k = 0\\) for all \\(\\xi_1, \\ldots, \\xi_m\\). Derivation with respect to \\(\\xi_l\\) leads to \\[\n0 = L_{jk} \\, \\delta_{jl} \\, \\xi_k + L_{jk} \\, \\xi_j \\, \\delta_{kl} = L_{lk} \\, \\xi_k + L_{jl} \\, \\xi_j = \\bigl(L_{kl} +L_{lk} \\bigr) \\, \\xi_l,\n\\] for all \\(\\xi_1, \\ldots, \\xi_m \\in \\reals\\). The above identity leads to: \\(L_{kl} + L_{lk} = 0\\). Application to Eq. (5.2) leads to \\[\nE_{ijk} + \\lambda_k \\, \\dot{E}_{ij} + \\lambda_j \\, \\dot{E}_{ik} = 0,\n\\tag{A.1}\\]\nWe now turn to Eq. (5.3), wich holds for all \\(\\xi_1, \\ldots, \\xi_m\\). Plugging \\(\\xi_i = \\order[1]{\\xi_i}\\) and using Eq. (5.1) delivers \\[\n\\begin{aligned}[b]\n\\tfrac{1}{3} \\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k \\, \\order[1]{\\xi}_l \\, \\bigl[ \\E_4(v_i, v_j, v_k, v_l)\n+ 3\\E_3(v_i, v_j, w_{kl}) \\bigr] &\\\\\n+ \\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k \\, \\order[1]{\\lambda} \\, \\bigl[ \\dot{\\E}_3(v_i, v_j, v_k)\n+ 2\\E_3(v_i, v_j, w_{k\\lambda}) + \\dot{\\E}_2(v_i, w_{jk}) \\bigr] &\\\\\n+ \\order[1]{\\xi}_j \\, \\bigl[ \\order[1]{\\lambda} \\bigr]^2 \\, \\bigl[ 2\\dot{\\E}_2(v_i, w_{j\\lambda})\n+ \\ddot{\\E}_2(v_i, v_j) \\bigr]\n+ \\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k \\, \\order[1]{\\xi}_l \\, \\lambda_{kl} \\, \\dot{\\E}_2(v_i, v_j) &= 0.\n\\end{aligned}\n\\tag{A.2}\\]\nOwing to the contraction with \\(\\order[1]{\\xi}_j\\), \\(\\order[1]{\\xi}_k\\) and \\(\\order[1]{\\xi}_l\\), the first term can be symmetrized with respect to \\(j\\), \\(k\\) and \\(l\\) \\[\n\\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k \\, \\order[1]{\\xi}_l \\, \\bigl[ \\E_4(v_i, v_j, v_k, v_l) + 3\\E_3(v_i, v_j, w_{kl}) \\bigr]\n= E_{ijkl} \\, \\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k \\, \\order[1]{\\xi}_l,\n\\] where \\(E_{ijkl}\\) is defined by Eq. (5.10). Similarly, the second term can be symmetrized with respect to \\(j\\) and \\(k\\) \\[\n\\begin{aligned}\n2 \\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k \\, \\E_3(v_i, v_j, w_{k\\lambda})\n&= \\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k \\, \\bigl[ \\E_3(v_i, v_j, w_{k\\lambda}) + \\E_3(v_i, v_k, w_{j\\lambda}) \\bigr]\\\\\n&= -\\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k \\, \\bigl[ \\E_2(w_{ij}, w_{k\\lambda}) + \\E_2(w_{ik}, w_{j\\lambda}) \\bigr]\\\\\n&= \\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k \\, \\bigl[ \\dot{\\E}_2(v_k, w_{ij}) + \\dot{\\E}_2(v_j, w_{ik}) \\bigr],\n\\end{aligned}\n\\] where we have been testing Eq. (4.8) with \\(\\hat{w} = w_{k\\lambda}\\) and \\(\\hat{w} = w_{j\\lambda}\\) and Eq. (4.9) with \\(\\hat{w} = w_{ij}\\) and \\(\\hat{w} = w_{ik}\\), successively. Introducing \\(\\dot{E}_{ijk}\\) defined by Eq. (5.9), the second term of Eq. (A.2) reduces to \\[\n\\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k \\, \\order[1]{\\lambda} \\, \\bigl[\n\\dot{\\E}_3(v_i, v_j, v_k) + 2\\E_3(v_i, v_j, w_{k\\lambda}) + \\dot{\\E}_2(v_i, w_{jk})\n\\bigr] = \\order[1]{\\lambda} \\, \\dot{E}_{ijk} \\, \\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k.\n\\]\nThe third term of Eq. (A.2) is simplified by testing Eq. (4.9), with \\(\\hat{w} = w_{j\\lambda}\\) and \\(\\hat{w} = w_{i\\lambda}\\), successively \\[\n\\begin{aligned}[b]\n\\ddot{\\E}_2(v_i, v_j) + 2\\dot{\\E}_2(v_i, w_{j\\lambda})\n&= \\ddot{\\E}_2(v_i, v_j) + \\dot{\\E}_2(v_i, w_{j\\lambda}) -\\E_2(w_{i\\lambda}, w_{j\\lambda})\\\\\n&= \\ddot{\\E}_2(v_i, v_j) + \\dot{\\E}_2(v_i, w_{j\\lambda}) + \\E_2(v_j, w_{i\\lambda})\\\\\n&= \\ddot{E}_{ij},\n\\end{aligned}\n\\] where \\(\\ddot{E}_{ij}\\) is defined by Eq. (5.8). Gathering the above results delivers the following equation \\[\n\\begin{aligned}\n\\tfrac{1}{3} E_{ijkl} \\, \\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k \\, \\order[1]{\\xi}_l\n+ \\order[1]{\\lambda} \\, \\dot{E}_{ijk} \\, \\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k\n+ \\bigl[ \\order[1]{\\lambda} \\bigr]^2 \\, \\ddot{E}_{ij} \\, \\order[1]{\\xi}_j &\\\\\n+ \\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k \\, \\order[1]{\\xi}_l \\, \\lambda_{kl} \\, \\dot{E}_{ij} &= 0.\n\\end{aligned}\n\\]\nUpon susbtitution of \\(\\order[1]{\\xi}_k \\, \\order[1]{\\xi}_l \\, \\lambda_{kl}\\) with \\(\\order[2]{\\lambda} - \\lambda_k \\, \\order[2]{\\xi_k}\\) [see Eq. (5.1)] \\[\n\\begin{aligned}[b]\n\\tfrac{1}{3} E_{ijkl} \\, \\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k \\, \\order[1]{\\xi}_l\n+ \\order[1]{\\lambda} \\, \\dot{E}_{ijk} \\, \\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k\n+ \\bigl[ \\order[1]{\\lambda} \\bigr]^2 \\, \\ddot{E}_{ij} \\, \\order[1]{\\xi}_j &\\\\\n+ \\order[2]{\\lambda} \\, \\dot{E}_{ij} \\, \\order[1]{\\xi}_j - \\order[1]{\\xi}_j \\, \\order[2]{\\xi}_k \\, \\lambda_k \\, \\dot{E}_{ij} &= 0.\n\\end{aligned}\n\\]\nEq. (A.1) is used to eliminate \\(\\lambda_k \\, \\dot{E}_{ij}\\) \\[\n\\begin{aligned}[b]\n\\tfrac{1}{3} E_{ijkl} \\, \\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k \\, \\order[1]{\\xi}_l\n+ \\order[1]{\\lambda} \\, \\dot{E}_{ijk} \\, \\order[1]{\\xi}_j \\, \\order[1]{\\xi}_k\n+ \\bigl[ \\order[1]{\\lambda} \\bigr]^2 \\, \\ddot{E}_{ij} \\, \\order[1]{\\xi}_j &\\\\\n+ \\order[2]{\\lambda} \\, \\dot{E}_{ij} \\, \\order[1]{\\xi}_j\n+ \\order[1]{\\xi}_j \\, \\order[2]{\\xi}_k \\, \\bigl( E_{ijk} + \\lambda_j \\, \\dot{E}_{ik} \\bigr) &= 0\n\\end{aligned}\n\\] and Eq. (5.5) is retrieved."
  },
  {
    "objectID": "problem_setting.html#sec-20230103084732",
    "href": "problem_setting.html#sec-20230103084732",
    "title": "3  Setting-up the computational stage",
    "section": "3.1 Computational setting",
    "text": "3.1 Computational setting\nWe will use the Python library SymPy for symbolic mathematics and rely also on the IPython library (in particular, IPython.display.Math) for pretty \\(\\LaTeX\\) output. Some useful functions are defined in the lsk.py module, which will be systematically imported.\nWithout loss of generality, it will be assumed in all symbolic calculations that \\(\\lambda_0 = 0\\) and \\(u_0 = 0\\). The general case \\(\\lambda_0 \\neq 0\\) and \\(u_0 \\neq 0\\) is readily recovered through the substitution \\(\\lambda \\leftrightarrow \\lambda - \\lambda_0\\) and \\(u \\leftrightarrow u - u_0\\).\nThe following developments involve the energy \\((u, \\lambda) \\mapsto \\E(u, \\lambda)\\) and its differentials at the critical point \\((u_0, \\lambda_0)\\), as well as the fundamental path \\(\\lambda \\mapsto u^\\ast(\\lambda)\\) and its derivatives at \\(\\lambda = \\lambda_0\\). It will therefore be convenient to express \\(\\E\\) and \\(u^\\star\\) as Taylor expansions with respect to \\(u\\) and \\(\\lambda\\).\nWe start with the Taylor expansion of the energy \\(\\E\\). We define its differentials at the critical point. These differentials are stored in a dictionary. Values are indexed with the order of the differentials with respect to \\(u\\) and \\(\\lambda\\).\n\n\n\n\n\n\nNote\n\n\n\nIn the following code blocks, n is the total order of the differential, p is the order of the differential with respect to \\(u\\) and q = n - p is the order of the differential with respect to \\(\\lambda\\).\n\n\n\nfrom sympy import *\n\n\n\n\n\n\n\nWarning\n\n\n\nThe above statement is extremely poor practice. We need it as sympy.srepr automatically drops the namespace. For example\n\nimport sympy.abc\nsrepr(sympy.abc.a + sympy.abc.b)\n\n\"Add(Symbol('a'), Symbol('b'))\"\n\n\nTherefore, in order to eval strings produced by sympy.srepr, as will be done in subsequent chapters, we will need all SymPy object to live in the global namespace.\n\n\n\nimport lsk\n\nλ, u, v, u_hat, v_hat, w_hat = sympy.symbols(r\"\\lambda u v \\hat{u} \\hat{v} \\hat{w}\")\n\n\ndE = dict()\nfor n in range(1, 5):\n    for p in range(n + 1):\n        q = n - p\n        if q == 0:\n            dE[p, q] = Symbol(r\"\\E_{}\".format(p))\n        else:\n            dE[p, q] = Symbol(r\"\\E_{\" + p * \"u\" + q * \"\\lambda\" + \"}\")\n            \n# Remember that the energy is stationary at the critical point (equilibrium)\ndE[1, 0] = Number(0)\n\nThe dictionary dE should be understood as follows: dE[(2, 1)] == dE[2, 1] is the symbol \\(\\E_{uu\\lambda}\\), which stands for \\(\\E_{,uu\\lambda}(u_0, \\lambda_0; \\bullet, \\bullet)\\). The following symbols have been defined.\n\n\nCode\n_dict = dict()\nfor n in range(1, 5):\n    for p in range(n + 1):\n        q = n - p\n        _dict[dE[p, q]] = (\"\\\\E_{,\" + p * \"u\" \n                           + q * \"\\\\lambda\"\n                           + \"}(u_0, \\lambda_0)\")\n        \nlsk.display_latex_dict(_dict, num_cols=3)\n\n\n\\(\\displaystyle \\begin{align}\\E_{\\lambda}&=\\E_{,\\lambda}(u_0, \\lambda_0)&0&=\\E_{,u}(u_0, \\lambda_0)&\\E_{\\lambda\\lambda}&=\\E_{,\\lambda\\lambda}(u_0, \\lambda_0)\\\\\\E_{u\\lambda}&=\\E_{,u\\lambda}(u_0, \\lambda_0)&\\E_{2}&=\\E_{,uu}(u_0, \\lambda_0)&\\E_{\\lambda\\lambda\\lambda}&=\\E_{,\\lambda\\lambda\\lambda}(u_0, \\lambda_0)\\\\\\E_{u\\lambda\\lambda}&=\\E_{,u\\lambda\\lambda}(u_0, \\lambda_0)&\\E_{uu\\lambda}&=\\E_{,uu\\lambda}(u_0, \\lambda_0)&\\E_{3}&=\\E_{,uuu}(u_0, \\lambda_0)\\\\\\E_{\\lambda\\lambda\\lambda\\lambda}&=\\E_{,\\lambda\\lambda\\lambda\\lambda}(u_0, \\lambda_0)&\\E_{u\\lambda\\lambda\\lambda}&=\\E_{,u\\lambda\\lambda\\lambda}(u_0, \\lambda_0)&\\E_{uu\\lambda\\lambda}&=\\E_{,uu\\lambda\\lambda}(u_0, \\lambda_0)\\\\\\E_{uuu\\lambda}&=\\E_{,uuu\\lambda}(u_0, \\lambda_0)&\\E_{4}&=\\E_{,uuuu}(u_0, \\lambda_0)&\\end{align}\\)\n\n\nwhere\n\n\\(\\E_\\lambda\\), \\(\\E_{\\lambda\\lambda}\\), \\(\\E_{\\lambda\\lambda\\lambda}\\) and \\(\\E_{\\lambda\\lambda\\lambda\\lambda}\\) are scalar quantities,\n\\(\\E_{u\\lambda}\\), \\(\\E_{u\\lambda\\lambda}\\) and \\(\\E_{u\\lambda\\lambda\\lambda}\\) are linear forms,\n\\(\\E_2\\), \\(\\E_{uu\\lambda}\\) and \\(\\E_{uu\\lambda\\lambda}\\) are bilinear forms,\n\\(\\E_3\\) and \\(\\E_{uuu\\lambda}\\) are trilinear forms,\n\\(\\E_4\\) is a quadrilinear form.\n\n\n\n\n\n\n\nImportant\n\n\n\nNote that all these differentials are defined as SymPy scalars. A definition as a SymPy function (e.g. E2 = Function(r\"\\E_2\")) would be more appropriate. However, SymPy would fail to account for multilinearity or symmetry of these forms. Therefore, we use the following trick: all multi-linear forms are defined as scalars, and the standard multiplication operator * means function application. In other words, E2 * (α * u + β * v) * w (resp. E2 * u * v - E2 * v * u) should be understood as E2(α * u + β * v, w) (resp. E2(u, v) - E2(v, u)). In both cases, the expressions would are correctly simplified.\nWhether the symbols in an expression are true scalars or vectors (elements of \\(U\\)) should be clear from the context. For example, in the expression: λ * E2 * u * v, the first * is a true multiplication, while the other * refer to function application.\n\n\nThe energy \\(\\E(u, \\lambda)\\) is now expressed as a Taylor expansion about the critical point.\n\n_f = lambda p, q: binomial(p + q, p) / factorial(p + q)\nE = sum(_f(p, q) * dE_pq * u**p * λ**q for (p, q), dE_pq in dE.items())\n\n\n\nCode\nlsk.display_latex_equation(r\"\\E(u, \\lambda)\", E)\n\n\n\\(\\displaystyle \\E(u, \\lambda)=\\frac{\\E_{2} u^{2}}{2} + \\frac{\\E_{3} u^{3}}{6} + \\frac{\\E_{4} u^{4}}{24} + \\frac{\\E_{\\lambda\\lambda\\lambda\\lambda} \\lambda^{4}}{24} + \\frac{\\E_{\\lambda\\lambda\\lambda} \\lambda^{3}}{6} + \\frac{\\E_{\\lambda\\lambda} \\lambda^{2}}{2} + \\E_{\\lambda} \\lambda + \\frac{\\E_{u\\lambda\\lambda\\lambda} \\lambda^{3} u}{6} + \\frac{\\E_{u\\lambda\\lambda} \\lambda^{2} u}{2} + \\E_{u\\lambda} \\lambda u + \\frac{\\E_{uu\\lambda\\lambda} \\lambda^{2} u^{2}}{4} + \\frac{\\E_{uu\\lambda} \\lambda u^{2}}{2} + \\frac{\\E_{uuu\\lambda} \\lambda u^{3}}{6}\\)\n\n\nWe now turn to the definition of the fundamental path \\(\\lambda \\mapsto u^\\star(\\lambda)\\). We first define in a dictionary the derivatives of \\(u^\\star\\) with respect to \\(\\lambda\\), at \\(\\lambda = \\lambda_0 = 0\\). For example, du_0[2] is the symbol \\(\\ddot{u}_0\\), which stands for \\(\\D^2 u^\\star / \\D \\lambda^2 \\rvert_{\\lambda=\\lambda_0}\\).\n\ndu_0 = {n: Symbol(\"\\\\\" + \"\".join(n * (\"d\",)) + \"ot{u}_0\") for n in range(1, 5)}\n\n_dict = {f\"\\\\frac{{\\\\D^{k}u^\\\\ast}}{{\\\\D \\\\lambda^{k}}}\" : v for k, v in du_0.items()}\n\n\n\nCode\nlsk.display_latex_dict(_dict, num_cols=4)\n\n\n\\(\\displaystyle \\begin{align}\\frac{\\D^1u^\\ast}{\\D \\lambda^1}&=\\dot{u}_0&\\frac{\\D^2u^\\ast}{\\D \\lambda^2}&=\\ddot{u}_0&\\frac{\\D^3u^\\ast}{\\D \\lambda^3}&=\\dddot{u}_0&\\frac{\\D^4u^\\ast}{\\D \\lambda^4}&=\\ddddot{u}_0\\\\\\end{align}\\)\n\n\nThe fundamental path is then defined through its Taylor expansion.\n\nu_star = sum(λ**n / factorial(n) * v for n, v in du_0.items())\n\n\n\nCode\nlsk.display_latex_equation(r\"u^\\star(\\lambda)\", u_star)\n\n\n\\(\\displaystyle u^\\star(\\lambda)=\\frac{\\ddddot{u}_0 \\lambda^{4}}{24} + \\frac{\\dddot{u}_0 \\lambda^{3}}{6} + \\frac{\\ddot{u}_0 \\lambda^{2}}{2} + \\dot{u}_0 \\lambda\\)"
  },
  {
    "objectID": "problem_setting.html#mathematical-setting",
    "href": "problem_setting.html#mathematical-setting",
    "title": "2  Setting up the stage",
    "section": "2.1 Mathematical setting",
    "text": "2.1 Mathematical setting\nThe space of admissible states of the system under consideration is denoted \\(U\\). It has the structure of a real vector space. The energy of the system is \\(\\E(u, \\lambda)\\), where \\(\\lambda\\) denotes a loading parameter. It is assumed that the fundamental branch of the equilibrium diagram, \\(u^\\ast(\\lambda)\\) is known. Then the energy is stationary with respect to the state \\(u\\) along the whole branch. In other words, for all \\(\\hat{u} \\in U\\) \\[\n\\E_{,u}[u^{\\ast}(\\lambda), \\lambda; \\hat{u}]=0,\n\\tag{2.1}\\] where \\(\\E_{,u}(u, \\lambda; \\hat{u})\\) denotes the (real) value of the differential of the energy \\(\\E\\) with respect to the state \\(u\\), evaluated at \\((u, \\lambda)\\), for the test function \\(\\hat{u}\\). Similarly, evaluation of the second-, third-, etc., order differential of the energy will be denoted \\(\\E_{,uu}(u, \\lambda; \\hat{u}, \\hat{v})\\), \\(\\E_{,uuu}(u, \\lambda; \\hat{u}, \\hat{v}, \\hat{w})\\), etc. It is assumed that a finite value \\(\\lambda_0 > 0\\) of \\(\\lambda\\) can be found (critical load), such that\n\n\\(\\E_{,uu}[u(\\lambda), \\lambda] > 0\\) for all \\(0 < \\lambda < \\lambda_0\\),\n\\(\\E_{,uu}(u_0, \\lambda_0) \\geq 0\\) but \\(\\E_{,uu}(u_0, \\lambda_0) \\ngtr 0\\),\n\\(\\E_{,uu}[u(\\lambda), \\lambda] < 0\\) for \\(\\lambda > \\lambda_0\\), close enough to \\(\\lambda_0\\).\n\nThe load \\(\\lambda_0\\) will be referred to as the critical load; similarly, the state \\(u_0\\) of the system at the critical load will be referred to as the critical state; finally, the pair \\((u_0, \\lambda_0)\\) is the critical point of the system. Assumption 1 implies that equilibria along the fundamental branch are stable below the critical load. Conversely, it results from assumption 3 that equilibrium points on the fundamental branch are unstable above the critical load. Stability at the critical load is yet undetermined.\nThe goal of these notes is to analyze all equilibrium paths that pass through the critical point \\((u_0, \\lambda_0)\\).\nWe introduce the following notations \\[\nu_0 = u^\\ast(\\lambda_0), \\quad \\dot{u}_0 = \\frac{\\D u^\\ast}{\\D \\lambda} \\biggr \\rvert_{\\lambda=\\lambda_0}, \\quad \\ddot{u}_0 = \\frac{\\D^2 u^\\ast}{\\D \\lambda^2} \\biggr \\rvert_{\\lambda=\\lambda_0}, \\quad \\dddot{u}_0 = \\ldots, \\quad \\ddddot{u}_0 = \\ldots\n\\] and \\[\n\\E_2 = \\E_{,uu}(u_0, \\lambda_0), \\quad \\E_3 = \\E_{,uuu}(u_0, \\lambda_0), \\quad \\E_4 = \\E_{,uuuu}(u_0, \\lambda_0).\n\\]\nNote that \\(\\E_2\\), \\(\\E_3\\) and \\(\\E_4\\) thus defined are bi-, tri- and quadrilinear forms, respectively. The following derivatives are also introduced \\[\n\\dot{\\E}_2(\\hat{u}, \\hat{v}) = \\frac{\\D}{\\D\\lambda} \\E_{,uu}[ u^\\ast(\\lambda), \\lambda; \\hat{u}, \\hat{v}] \\biggr \\rvert_{\\lambda = \\lambda_0}\n= \\E_{,uuu}(u_0, \\lambda_0; \\dot{u}_0, \\hat{u}, \\hat{v}) + \\E_{,uu\\lambda}(u_0, \\lambda_0; \\hat{u}, \\hat{v})\n\\tag{2.2}\\] \\[\n  \\begin{aligned}[b]\n    \\ddot{\\E}_2(\\hat{u}, \\hat{v}) = \\frac{\\D^2}{\\D\\lambda^2} \\E_{,uu}[ u^\\ast(\\lambda), \\lambda; \\hat{u}, \\hat{v}] \\biggr \\rvert_{\\lambda = \\lambda_0}\n    ={} & \\E_{,uuuu}(u_0, \\lambda_0; \\dot{u}_0, \\dot{u}_0, \\hat{u}, \\hat{v}) + 2\\E_{,uuu\\lambda}(u_0, \\lambda_0; \\dot{u}_0, \\hat{u}, \\hat{v})\\\\\n    & + \\E_{,uu\\lambda\\lambda}( u_0, \\lambda_0; \\hat{u}, \\hat{v}) + \\E_{,uuu}(u_0, \\lambda_0, \\ddot{u}_0),\n  \\end{aligned}\n\\] and, similarly, \\(\\dot{\\E}_3\\), \\(\\ddot{\\E}_3\\), etc."
  },
  {
    "objectID": "problem_setting.html#elimination-of-the-mixed-derivatives-of-the-energy",
    "href": "problem_setting.html#elimination-of-the-mixed-derivatives-of-the-energy",
    "title": "2  Setting up the stage",
    "section": "2.3 Elimination of the mixed derivatives of the energy",
    "text": "2.3 Elimination of the mixed derivatives of the energy\nSince the fundamental path \\(\\lambda \\mapsto u^\\ast(\\lambda)\\) is an equilibrium path, the various differentials of the energy at the critical point are not linearly independent. To express the relationships between these forms, we define \\(\\mathcal R^\\ast(\\lambda; \\bullet)\\) as the jacobian of the energy along the fundamental path \\(u^\\ast(\\lambda)\\)\n\\[\n\\mathcal R^\\ast(\\lambda; \\bullet) = \\E_{,u}[u^\\ast(\\lambda), \\lambda; \\bullet].\n\\]\n\nR_star = (E.diff(u) * u_hat).subs(u, u_star).expand()\n\n\n\nCode\ndisplay_latex_equation(r\"\\mathcal{R}^\\ast(\\lambda;\" + sympy.latex(u_hat) + \")\",\n                       R_star.series(λ, 0, 5))\n\n\n\\(\\displaystyle \\mathcal{R}^\\ast(\\lambda;\\hat{u})=\\lambda \\left(\\E_{2} \\dot{u}_0 \\hat{u} + \\E_{u\\lambda} \\hat{u}\\right) + \\lambda^{2} \\left(\\frac{\\E_{2} \\ddot{u}_0 \\hat{u}}{2} + \\frac{\\E_{3} \\dot{u}_0^{2} \\hat{u}}{2} + \\frac{\\E_{u\\lambda\\lambda} \\hat{u}}{2} + \\E_{uu\\lambda} \\dot{u}_0 \\hat{u}\\right) + \\lambda^{3} \\left(\\frac{\\E_{2} \\dddot{u}_0 \\hat{u}}{6} + \\frac{\\E_{3} \\ddot{u}_0 \\dot{u}_0 \\hat{u}}{2} + \\frac{\\E_{4} \\dot{u}_0^{3} \\hat{u}}{6} + \\frac{\\E_{u\\lambda\\lambda\\lambda} \\hat{u}}{6} + \\frac{\\E_{uu\\lambda\\lambda} \\dot{u}_0 \\hat{u}}{2} + \\frac{\\E_{uu\\lambda} \\ddot{u}_0 \\hat{u}}{2} + \\frac{\\E_{uuu\\lambda} \\dot{u}_0^{2} \\hat{u}}{2}\\right) + \\lambda^{4} \\left(\\frac{\\E_{2} \\ddddot{u}_0 \\hat{u}}{24} + \\frac{\\E_{3} \\dddot{u}_0 \\dot{u}_0 \\hat{u}}{6} + \\frac{\\E_{3} \\ddot{u}_0^{2} \\hat{u}}{8} + \\frac{\\E_{4} \\ddot{u}_0 \\dot{u}_0^{2} \\hat{u}}{4} + \\frac{\\E_{uu\\lambda\\lambda} \\ddot{u}_0 \\hat{u}}{4} + \\frac{\\E_{uu\\lambda} \\dddot{u}_0 \\hat{u}}{6} + \\frac{\\E_{uuu\\lambda} \\ddot{u}_0 \\dot{u}_0 \\hat{u}}{2}\\right) + O\\left(\\lambda^{5}\\right)\\)\n\n\nOf course, since \\(\\lambda \\mapsto u^\\ast(\\lambda)\\) is an equilibrium path, we have \\(\\mathcal R^\\ast(\\lambda; \\bullet) = 0\\) for all \\(\\lambda\\). Therefore, all coefficients of the above polynomial in \\(\\lambda\\) are null, which delivers expressions of \\(\\E_{u\\lambda}\\), \\(\\E_{u\\lambda\\lambda}\\) and \\(\\E_{u\\lambda\\lambda\\lambda}\\)\n\nmixed1 = dict()\n\nfor q in range(1, 4):\n    x = dE[1, q]\n    eq = R_star.coeff(λ, q)\n    sol = sympy.solve(eq, x)[0]\n    mixed1[x] = sol\n\n\n\nCode\ndisplay_latex_dict(mixed1, num_cols=1)\n\n\n\\(\\displaystyle \\begin{align}\\E_{u\\lambda}&=- \\E_{2} \\dot{u}_0\\\\\\E_{u\\lambda\\lambda}&=- \\E_{2} \\ddot{u}_0 - \\E_{3} \\dot{u}_0^{2} - 2 \\E_{uu\\lambda} \\dot{u}_0\\\\\\E_{u\\lambda\\lambda\\lambda}&=- \\E_{2} \\dddot{u}_0 - 3 \\E_{3} \\ddot{u}_0 \\dot{u}_0 - \\E_{4} \\dot{u}_0^{3} - 3 \\E_{uu\\lambda\\lambda} \\dot{u}_0 - 3 \\E_{uu\\lambda} \\ddot{u}_0 - 3 \\E_{uuu\\lambda} \\dot{u}_0^{2}\\\\\\end{align}\\)\n\n\nWe want to get rid of the remaining mixed derivatives, namely: \\(\\E_{uu\\lambda}\\), \\(\\E_{uuu\\lambda}\\) and \\(\\E_{uu\\lambda\\lambda}\\). To do so, we introduce the derivatives \\(\\dot{\\E}_2\\), \\(\\ddot{\\E}_2\\) and \\(\\dot{\\E}_3\\) defined in Chapter 2.\n\nE2_dot, E2_ddot, E3_dot = sympy.symbols(\"\\dot{\\E}_2 \\ddot{\\E}_2 \\dot{\\E}_3\")\n\nE_uu_star = E.diff(u, 2).subs(u, u_star).expand()\nE_uuu_star = E.diff(u, 3).subs(u, u_star).expand()\n\neqs = [sympy.Eq(E2_dot, E_uu_star.coeff(λ, 1)),\n       sympy.Eq(E3_dot, E_uuu_star.coeff(λ, 1)),\n       sympy.Eq(E2_ddot, 2 * E_uu_star.coeff(λ, 2))]\n\nunknowns = [dE[2, 1], dE[3, 1], dE[2, 2]] # E_uuλ, E_uuuλ, E_uuλλ\n\nmixed2 = dict()\nfor eq, x in zip(eqs, unknowns):\n    mixed2[x] = sympy.solve(eq, x)[0].subs(mixed2).expand()\n\nWe get the following expressions\n\n\nCode\ndisplay_latex_dict(mixed2, num_cols=1)\n\n\n\\(\\displaystyle \\begin{align}\\E_{uu\\lambda}&=- \\E_{3} \\dot{u}_0 + \\dot{\\E}_2\\\\\\E_{uuu\\lambda}&=- \\E_{4} \\dot{u}_0 + \\dot{\\E}_3\\\\\\E_{uu\\lambda\\lambda}&=- \\E_{3} \\ddot{u}_0 + \\E_{4} \\dot{u}_0^{2} + \\ddot{\\E}_2 - 2 \\dot{\\E}_3 \\dot{u}_0\\\\\\end{align}\\)\n\n\nCombining the above results allows to fully eliminate the mixed derivatives\n\n\nCode\nmixed = {k: v.subs(mixed2).expand() for k, v in mixed1.items()}\nmixed.update(mixed2)\n\ndisplay_latex_dict(mixed, num_cols=1)\n\n\n\\(\\displaystyle \\begin{align}\\E_{u\\lambda}&=- \\E_{2} \\dot{u}_0\\\\\\E_{u\\lambda\\lambda}&=- \\E_{2} \\ddot{u}_0 + \\E_{3} \\dot{u}_0^{2} - 2 \\dot{\\E}_2 \\dot{u}_0\\\\\\E_{u\\lambda\\lambda\\lambda}&=- \\E_{2} \\dddot{u}_0 + 3 \\E_{3} \\ddot{u}_0 \\dot{u}_0 - \\E_{4} \\dot{u}_0^{3} - 3 \\ddot{\\E}_2 \\dot{u}_0 - 3 \\ddot{u}_0 \\dot{\\E}_2 + 3 \\dot{\\E}_3 \\dot{u}_0^{2}\\\\\\E_{uu\\lambda}&=- \\E_{3} \\dot{u}_0 + \\dot{\\E}_2\\\\\\E_{uuu\\lambda}&=- \\E_{4} \\dot{u}_0 + \\dot{\\E}_3\\\\\\E_{uu\\lambda\\lambda}&=- \\E_{3} \\ddot{u}_0 + \\E_{4} \\dot{u}_0^{2} + \\ddot{\\E}_2 - 2 \\dot{\\E}_3 \\dot{u}_0\\\\\\end{align}\\)\n\n\nThese expressions can be plugged into the expansion of the energy.\n\nE = E.subs(mixed).expand()\n\n\n\nCode\ndisplay_latex_equation(r\"\\E(u, \\lambda)\", E)\n\n\n\\(\\displaystyle \\E(u, \\lambda)=- \\frac{\\E_{2} \\dddot{u}_0 \\lambda^{3} u}{6} - \\frac{\\E_{2} \\ddot{u}_0 \\lambda^{2} u}{2} - \\E_{2} \\dot{u}_0 \\lambda u + \\frac{\\E_{2} u^{2}}{2} + \\frac{\\E_{3} \\ddot{u}_0 \\dot{u}_0 \\lambda^{3} u}{2} - \\frac{\\E_{3} \\ddot{u}_0 \\lambda^{2} u^{2}}{4} + \\frac{\\E_{3} \\dot{u}_0^{2} \\lambda^{2} u}{2} - \\frac{\\E_{3} \\dot{u}_0 \\lambda u^{2}}{2} + \\frac{\\E_{3} u^{3}}{6} - \\frac{\\E_{4} \\dot{u}_0^{3} \\lambda^{3} u}{6} + \\frac{\\E_{4} \\dot{u}_0^{2} \\lambda^{2} u^{2}}{4} - \\frac{\\E_{4} \\dot{u}_0 \\lambda u^{3}}{6} + \\frac{\\E_{4} u^{4}}{24} + \\frac{\\E_{\\lambda\\lambda\\lambda\\lambda} \\lambda^{4}}{24} + \\frac{\\E_{\\lambda\\lambda\\lambda} \\lambda^{3}}{6} + \\frac{\\E_{\\lambda\\lambda} \\lambda^{2}}{2} + \\E_{\\lambda} \\lambda - \\frac{\\ddot{\\E}_2 \\dot{u}_0 \\lambda^{3} u}{2} + \\frac{\\ddot{\\E}_2 \\lambda^{2} u^{2}}{4} - \\frac{\\ddot{u}_0 \\dot{\\E}_2 \\lambda^{3} u}{2} - \\dot{\\E}_2 \\dot{u}_0 \\lambda^{2} u + \\frac{\\dot{\\E}_2 \\lambda u^{2}}{2} + \\frac{\\dot{\\E}_3 \\dot{u}_0^{2} \\lambda^{3} u}{2} - \\frac{\\dot{\\E}_3 \\dot{u}_0 \\lambda^{2} u^{2}}{2} + \\frac{\\dot{\\E}_3 \\lambda u^{3}}{6}\\)\n\n\nSome of the previous symbolic results are now saved for further use in the subsequent notebooks.\n\ndata = {\"E\" : sympy.srepr(E)}\n\nwith open(\"problem_setting.out.json\", \"w\") as f:\n    json.dump(data, f)"
  },
  {
    "objectID": "problem_setting.html#sec-20230208081323",
    "href": "problem_setting.html#sec-20230208081323",
    "title": "3  Setting up the stage",
    "section": "3.1 Mathematical setting",
    "text": "3.1 Mathematical setting"
  },
  {
    "objectID": "problem_setting.html#sec-20230208081549",
    "href": "problem_setting.html#sec-20230208081549",
    "title": "3  Setting-up the computational stage",
    "section": "3.2 Elimination of the mixed derivatives of the energy",
    "text": "3.2 Elimination of the mixed derivatives of the energy\nSince the fundamental path \\(\\lambda \\mapsto u^\\ast(\\lambda)\\) is an equilibrium path, the various differentials of the energy at the critical point are not linearly independent. To express the relationships between these forms, we define \\(\\mathcal R^\\ast(\\lambda; \\bullet)\\) as the jacobian of the energy along the fundamental path \\(u^\\ast(\\lambda)\\) \\[\n\\mathcal R^\\ast(\\lambda; \\bullet) = \\E_{,u}[u^\\ast(\\lambda), \\lambda; \\bullet].\n\\]\n\nR_star = (E.diff(u) * u_hat).subs(u, u_star).expand()\n\n\n\nCode\nlsk.display_latex_equation(r\"\\mathcal{R}^\\ast(\\lambda;\" + sympy.latex(u_hat) + \")\",\n                           R_star.series(λ, 0, 5))\n\n\n\\(\\displaystyle \\mathcal{R}^\\ast(\\lambda;\\hat{u})=\\lambda \\left(\\E_{2} \\dot{u}_0 \\hat{u} + \\E_{u\\lambda} \\hat{u}\\right) + \\lambda^{2} \\left(\\frac{\\E_{2} \\ddot{u}_0 \\hat{u}}{2} + \\frac{\\E_{3} \\dot{u}_0^{2} \\hat{u}}{2} + \\frac{\\E_{u\\lambda\\lambda} \\hat{u}}{2} + \\E_{uu\\lambda} \\dot{u}_0 \\hat{u}\\right) + \\lambda^{3} \\left(\\frac{\\E_{2} \\dddot{u}_0 \\hat{u}}{6} + \\frac{\\E_{3} \\ddot{u}_0 \\dot{u}_0 \\hat{u}}{2} + \\frac{\\E_{4} \\dot{u}_0^{3} \\hat{u}}{6} + \\frac{\\E_{u\\lambda\\lambda\\lambda} \\hat{u}}{6} + \\frac{\\E_{uu\\lambda\\lambda} \\dot{u}_0 \\hat{u}}{2} + \\frac{\\E_{uu\\lambda} \\ddot{u}_0 \\hat{u}}{2} + \\frac{\\E_{uuu\\lambda} \\dot{u}_0^{2} \\hat{u}}{2}\\right) + \\lambda^{4} \\left(\\frac{\\E_{2} \\ddddot{u}_0 \\hat{u}}{24} + \\frac{\\E_{3} \\dddot{u}_0 \\dot{u}_0 \\hat{u}}{6} + \\frac{\\E_{3} \\ddot{u}_0^{2} \\hat{u}}{8} + \\frac{\\E_{4} \\ddot{u}_0 \\dot{u}_0^{2} \\hat{u}}{4} + \\frac{\\E_{uu\\lambda\\lambda} \\ddot{u}_0 \\hat{u}}{4} + \\frac{\\E_{uu\\lambda} \\dddot{u}_0 \\hat{u}}{6} + \\frac{\\E_{uuu\\lambda} \\ddot{u}_0 \\dot{u}_0 \\hat{u}}{2}\\right) + O\\left(\\lambda^{5}\\right)\\)\n\n\nOf course, since \\(\\lambda \\mapsto u^\\ast(\\lambda)\\) is an equilibrium path, we have \\(\\mathcal R^\\ast(\\lambda; \\bullet) = 0\\) for all \\(\\lambda\\). Therefore, all coefficients of the above polynomial in \\(\\lambda\\) are null, which delivers expressions of \\(\\E_{u\\lambda}\\), \\(\\E_{u\\lambda\\lambda}\\) and \\(\\E_{u\\lambda\\lambda\\lambda}\\)\n\nmixed1 = dict()\n\nfor q in range(1, 4):\n    x = dE[1, q]\n    eq = R_star.coeff(λ, q)\n    sol = solve(eq, x)[0]\n    mixed1[x] = sol\n\n\n\nCode\nlsk.display_latex_dict(mixed1, num_cols=1)\n\n\n\\(\\displaystyle \\begin{align}\\E_{u\\lambda}&=- \\E_{2} \\dot{u}_0\\\\\\E_{u\\lambda\\lambda}&=- \\E_{2} \\ddot{u}_0 - \\E_{3} \\dot{u}_0^{2} - 2 \\E_{uu\\lambda} \\dot{u}_0\\\\\\E_{u\\lambda\\lambda\\lambda}&=- \\E_{2} \\dddot{u}_0 - 3 \\E_{3} \\ddot{u}_0 \\dot{u}_0 - \\E_{4} \\dot{u}_0^{3} - 3 \\E_{uu\\lambda\\lambda} \\dot{u}_0 - 3 \\E_{uu\\lambda} \\ddot{u}_0 - 3 \\E_{uuu\\lambda} \\dot{u}_0^{2}\\\\\\end{align}\\)\n\n\nWe want to get rid of the remaining mixed derivatives, namely: \\(\\E_{uu\\lambda}\\), \\(\\E_{uuu\\lambda}\\) and \\(\\E_{uu\\lambda\\lambda}\\). To do so, we introduce the derivatives \\(\\dot{\\E}_2\\), \\(\\ddot{\\E}_2\\) and \\(\\dot{\\E}_3\\) defined in ?sec-20230105101657.\n\nE2_dot, E2_ddot, E3_dot = sympy.symbols(\"\\dot{\\E}_2 \\ddot{\\E}_2 \\dot{\\E}_3\")\n\nE_uu_star = E.diff(u, 2).subs(u, u_star).expand()\nE_uuu_star = E.diff(u, 3).subs(u, u_star).expand()\n\neqs = [Eq(E2_dot, E_uu_star.coeff(λ, 1)),\n       Eq(E3_dot, E_uuu_star.coeff(λ, 1)),\n       Eq(E2_ddot, 2 * E_uu_star.coeff(λ, 2))]\n\nunknowns = [dE[2, 1], dE[3, 1], dE[2, 2]] # E_uuλ, E_uuuλ, E_uuλλ\n\nmixed2 = dict()\nfor eq, x in zip(eqs, unknowns):\n    mixed2[x] = solve(eq, x)[0].subs(mixed2).expand()\n\nWe get the following expressions\n\n\nCode\nlsk.display_latex_dict(mixed2, num_cols=1)\n\n\n\\(\\displaystyle \\begin{align}\\E_{uu\\lambda}&=- \\E_{3} \\dot{u}_0 + \\dot{\\E}_2\\\\\\E_{uuu\\lambda}&=- \\E_{4} \\dot{u}_0 + \\dot{\\E}_3\\\\\\E_{uu\\lambda\\lambda}&=- \\E_{3} \\ddot{u}_0 + \\E_{4} \\dot{u}_0^{2} + \\ddot{\\E}_2 - 2 \\dot{\\E}_3 \\dot{u}_0\\\\\\end{align}\\)\n\n\nCombining the above results allows to fully eliminate the mixed derivatives\n\n\nCode\nmixed = {k: v.subs(mixed2).expand() for k, v in mixed1.items()}\nmixed.update(mixed2)\n\nlsk.display_latex_dict(mixed, num_cols=1)\n\n\n\\(\\displaystyle \\begin{align}\\E_{u\\lambda}&=- \\E_{2} \\dot{u}_0\\\\\\E_{u\\lambda\\lambda}&=- \\E_{2} \\ddot{u}_0 + \\E_{3} \\dot{u}_0^{2} - 2 \\dot{\\E}_2 \\dot{u}_0\\\\\\E_{u\\lambda\\lambda\\lambda}&=- \\E_{2} \\dddot{u}_0 + 3 \\E_{3} \\ddot{u}_0 \\dot{u}_0 - \\E_{4} \\dot{u}_0^{3} - 3 \\ddot{\\E}_2 \\dot{u}_0 - 3 \\ddot{u}_0 \\dot{\\E}_2 + 3 \\dot{\\E}_3 \\dot{u}_0^{2}\\\\\\E_{uu\\lambda}&=- \\E_{3} \\dot{u}_0 + \\dot{\\E}_2\\\\\\E_{uuu\\lambda}&=- \\E_{4} \\dot{u}_0 + \\dot{\\E}_3\\\\\\E_{uu\\lambda\\lambda}&=- \\E_{3} \\ddot{u}_0 + \\E_{4} \\dot{u}_0^{2} + \\ddot{\\E}_2 - 2 \\dot{\\E}_3 \\dot{u}_0\\\\\\end{align}\\)\n\n\nThese expressions can be plugged into the expansion of the energy.\n\nE = E.subs(mixed).expand()\n\n\n\nCode\nlsk.display_latex_equation(r\"\\E(u, \\lambda)\", E)\n\n\n\\(\\displaystyle \\E(u, \\lambda)=- \\frac{\\E_{2} \\dddot{u}_0 \\lambda^{3} u}{6} - \\frac{\\E_{2} \\ddot{u}_0 \\lambda^{2} u}{2} - \\E_{2} \\dot{u}_0 \\lambda u + \\frac{\\E_{2} u^{2}}{2} + \\frac{\\E_{3} \\ddot{u}_0 \\dot{u}_0 \\lambda^{3} u}{2} - \\frac{\\E_{3} \\ddot{u}_0 \\lambda^{2} u^{2}}{4} + \\frac{\\E_{3} \\dot{u}_0^{2} \\lambda^{2} u}{2} - \\frac{\\E_{3} \\dot{u}_0 \\lambda u^{2}}{2} + \\frac{\\E_{3} u^{3}}{6} - \\frac{\\E_{4} \\dot{u}_0^{3} \\lambda^{3} u}{6} + \\frac{\\E_{4} \\dot{u}_0^{2} \\lambda^{2} u^{2}}{4} - \\frac{\\E_{4} \\dot{u}_0 \\lambda u^{3}}{6} + \\frac{\\E_{4} u^{4}}{24} + \\frac{\\E_{\\lambda\\lambda\\lambda\\lambda} \\lambda^{4}}{24} + \\frac{\\E_{\\lambda\\lambda\\lambda} \\lambda^{3}}{6} + \\frac{\\E_{\\lambda\\lambda} \\lambda^{2}}{2} + \\E_{\\lambda} \\lambda - \\frac{\\ddot{\\E}_2 \\dot{u}_0 \\lambda^{3} u}{2} + \\frac{\\ddot{\\E}_2 \\lambda^{2} u^{2}}{4} - \\frac{\\ddot{u}_0 \\dot{\\E}_2 \\lambda^{3} u}{2} - \\dot{\\E}_2 \\dot{u}_0 \\lambda^{2} u + \\frac{\\dot{\\E}_2 \\lambda u^{2}}{2} + \\frac{\\dot{\\E}_3 \\dot{u}_0^{2} \\lambda^{3} u}{2} - \\frac{\\dot{\\E}_3 \\dot{u}_0 \\lambda^{2} u^{2}}{2} + \\frac{\\dot{\\E}_3 \\lambda u^{3}}{6}\\)\n\n\nSome of the previous symbolic results are now saved for further use in the subsequent notebooks.\n\nimport json\n\ndata = {\n    \"E\" : srepr(E),\n    \"u_star\": srepr(u_star)\n}\n\nwith open(\"setting-up_the_computational_stage.out.json\", \"w\") as f:\n    json.dump(data, f)"
  },
  {
    "objectID": "bifurcation_equations.html#outline-of-the-strategy",
    "href": "bifurcation_equations.html#outline-of-the-strategy",
    "title": "4  Bifurcation equations",
    "section": "4.1 Outline of the strategy",
    "text": "4.1 Outline of the strategy\nIn this section, we show that, besides the fundamental branch \\(u^\\ast(\\lambda)\\), other (bifurcated) equilibrium branches may pass through the critical point \\((u_0, \\lambda_0)\\). The starting point is the characterization of an equilibrium by the stationarity of the energy, which defines all equilibrium branches as implicit functions, which can be expanded with respect to some perturbation parameter.\nThe approach adopted here relies on the Lyapunov–Schmidt decomposition of the equilibrium branch over \\(V\\) and \\(W\\). Other approaches are possible, see e.g. Chakrabarti et al. (2018).\nFor a given value of \\(\\lambda\\) (close to the critical value \\(\\lambda_0\\)), we seek an equilibrium point \\(u\\) of the system, such that\n\\[\n\\E_{,u}(u, \\lambda; \\hat{u}) = 0 \\quad \\text{for all} \\quad \\hat{u} \\in U.\n\\tag{4.1}\\]\n\nres = (E.diff(u) * u_hat).expand()\n\nThe above equation reads: for all \\(\\hat{u} \\in U\\)\n\n\nCode\nlsk.display_latex_equation(res, 0)\n\n\n\\(\\displaystyle - \\frac{\\E_{2} \\dddot{u}_0 \\hat{u} \\lambda^{3}}{6} - \\frac{\\E_{2} \\ddot{u}_0 \\hat{u} \\lambda^{2}}{2} - \\E_{2} \\dot{u}_0 \\hat{u} \\lambda + \\E_{2} \\hat{u} u + \\frac{\\E_{3} \\ddot{u}_0 \\dot{u}_0 \\hat{u} \\lambda^{3}}{2} - \\frac{\\E_{3} \\ddot{u}_0 \\hat{u} \\lambda^{2} u}{2} + \\frac{\\E_{3} \\dot{u}_0^{2} \\hat{u} \\lambda^{2}}{2} - \\E_{3} \\dot{u}_0 \\hat{u} \\lambda u + \\frac{\\E_{3} \\hat{u} u^{2}}{2} - \\frac{\\E_{4} \\dot{u}_0^{3} \\hat{u} \\lambda^{3}}{6} + \\frac{\\E_{4} \\dot{u}_0^{2} \\hat{u} \\lambda^{2} u}{2} - \\frac{\\E_{4} \\dot{u}_0 \\hat{u} \\lambda u^{2}}{2} + \\frac{\\E_{4} \\hat{u} u^{3}}{6} - \\frac{\\ddot{\\E}_2 \\dot{u}_0 \\hat{u} \\lambda^{3}}{2} + \\frac{\\ddot{\\E}_2 \\hat{u} \\lambda^{2} u}{2} - \\frac{\\ddot{u}_0 \\dot{\\E}_2 \\hat{u} \\lambda^{3}}{2} - \\dot{\\E}_2 \\dot{u}_0 \\hat{u} \\lambda^{2} + \\dot{\\E}_2 \\hat{u} \\lambda u + \\frac{\\dot{\\E}_3 \\dot{u}_0^{2} \\hat{u} \\lambda^{3}}{2} - \\dot{\\E}_3 \\dot{u}_0 \\hat{u} \\lambda^{2} u + \\frac{\\dot{\\E}_3 \\hat{u} \\lambda u^{2}}{2}=0\\)\n\n\nThe equilibrium state \\(u\\) is projected onto the orthogonal subspaces \\(V\\) and \\(W\\). \\[\nu = u^\\ast(\\lambda) + \\xi_i \\, v_i + w, \\quad \\text{with} \\quad w \\in W.\n\\tag{4.2}\\]\nIt follows from the orthogonality of \\(V\\) and \\(W\\) that \\(\\langle v_i, w \\rangle = 0\\) for all \\(i=1, \\ldots, m\\). Analysis of the bifurcated branches therefore reduces to finding \\(\\xi_1, \\ldots, \\xi_m \\in \\reals\\) and \\(w \\in W\\), such that \\[\n\\E_{,u}[u^\\ast(\\lambda) + \\xi_i \\, v_i + w, \\lambda; \\hat{u}] = 0 \\quad \\text{for all} \\quad \\hat{u} \\in U.\n\\tag{4.3}\\]\nThe method proceeds in three steps\n\nEq. (4.3) is first expressed for \\(\\hat{u} \\in W\\) which leads to a definition of \\(w\\) as an implicit function of \\(\\xi_1, \\ldots, \\xi_m\\) and \\(\\lambda\\) (see Section 4.2),\nEq. (4.3) is then expressed for \\(\\hat{u} \\in V\\) which leads to a definition of \\(\\lambda\\) as an implicit function of \\(\\xi_1, \\ldots, \\xi_m\\) (see Section 4.3),\nfinally, a parametrization \\(\\eta\\) of \\(\\xi_1, \\ldots, \\xi_m\\) is introduced and the Taylor expansion of \\(u\\) and \\(\\lambda\\) with respect to \\(\\eta\\) is derived (see Chapter 5)."
  },
  {
    "objectID": "bifurcation_equations.html#sec-20230102030010",
    "href": "bifurcation_equations.html#sec-20230102030010",
    "title": "4  Bifurcation equations",
    "section": "4.2 Elimination of \\(w\\)",
    "text": "4.2 Elimination of \\(w\\)\nWe first test Eq. (4.1) with \\(\\hat{w} \\in W\\) \\[\n\\E_{,u}[u^\\ast(\\lambda) + \\xi_i \\, v_i + w, \\lambda; \\hat{w}] = 0, \\quad \\text{for all} \\quad \\hat{w} \\in W.\n\\tag{4.4}\\]\nThis defines \\(w\\) as an implicit function of \\(\\xi_1, \\ldots, \\xi_m\\) and \\(\\lambda\\). The following asymptotic expansion about \\(\\xi_1 = \\cdots = \\xi_m = 0\\) and \\(\\lambda = \\lambda_0\\) is postulated \\[\n\\begin{aligned}\nw(\\xi_1, \\ldots, \\xi_m, \\lambda) ={} & \\xi_i \\, w_i + \\bigl( \\lambda - \\lambda_0 \\bigr) \\, w_\\lambda + \\tfrac{1}{2} \\xi_i \\, \\xi_j \\, w_{ij}\\\\\n&+ \\tfrac{1}{2} \\bigl( \\lambda - \\lambda_0 \\bigr)^2 w_{\\lambda\\lambda} + \\xi_i \\, \\bigl( \\lambda - \\lambda_0 \\bigr) w_{i\\lambda} + \\cdots,\n\\end{aligned}\n\\tag{4.5}\\] where \\(w_i\\), \\(w_\\lambda\\), \\(w_{ij}\\), \\(w_{\\lambda\\lambda}\\) and \\(w_{i\\lambda}\\) are elements of \\(W\\) to be defined.\n\n\n\n\n\n\nImportant\n\n\n\nIndicial expressions are somewhat difficult to handle in SymPy, we therefore use a “trick”\n\nξ stands for \\(\\xi_i\\),\nw_ξ stands for \\(w_i\\),\nw_ξξstands for \\(w_{ij}\\),\nw_ξλ stands for \\(w_{i\\lambda}\\).\n\nThen expressions such as ξ * w_ξ (resp. ξ^2 * w_ξξ) should be understood as \\(\\xi_i \\, w_i\\) (resp. \\(\\xi_i \\, \\xi_j \\, w_{ij}\\)).\n\n\n\nξ, w_ξ, w_λ, w_ξξ, w_ξλ, w_λλ = symbols(r\"\\xi w_\\xi w_\\lambda w_{\\xi\\xi} w_{\\xi\\lambda} w_{\\lambda\\lambda}\")\nw = ξ * w_ξ + λ * w_λ + (ξ**2 * w_ξξ + 2 * ξ * λ * w_ξλ + λ**2 * w_λλ) / 2\n\nIt will be useful to define the critical point\n\ncrit = {ξ: 0, λ: 0}\n\nEq. (4.5) is plugged into Eq. (4.4), which then delivers an asymptotic expansion of the stationarity equation. We will nullify the terms of order up to 2 in \\(\\xi_i\\) and \\(\\lambda\\).\n\nres_w = res.subs({u_hat: w_hat, u: u_star + ξ * v + w}).expand()\n\nWe can then nullify the various coefficients of this polynomial expansion, starting with the \\(\\xi_i\\) terms\n\neq = Eq(simplify_E2(res_w.coeff(ξ)), 0).subs(crit)\ndisplay(eq)\n\n\\(\\displaystyle \\E_{2} \\hat{w} w_{\\xi} = 0\\)\n\n\nwhich should be understood as\n\\[\n\\E_2(w_i, \\hat{w}) = 0 \\quad \\text{for all} \\quad \\hat{w} \\in W.\n\\]\nAs argued in Section 2.2, this leads to \\(w_i = 0\\). We now consider the \\(\\lambda\\) term\n\neq = Eq(simplify_E2(res_w.coeff(λ)), 0).subs(crit)\ndisplay(eq)\n\n\\(\\displaystyle \\E_{2} \\hat{w} w_{\\lambda} = 0\\)\n\n\nWhich sould be understood as\n\\[\n\\E_2(w_\\lambda, \\hat{w}) = 0 \\quad \\text{for all} \\quad \\hat{w} \\in W.\n\\]\nThis again leads to \\(w_\\lambda = 0\\). The \\(\\lambda^2\\) term again delivers then vanishes automatically.\n\\[\n\\E_2(w_{\\lambda\\lambda}, \\hat{w}) = 0 \\quad \\text{for all} \\quad \\hat{w} \\in W,\n\\]\nfrom which it results that \\(w_{\\lambda\\lambda} = 0\\)\n\nassert 2 * res_w.coeff(λ, 2).subs(crit).subs(w_λ, 0).expand() == E2 * w_λλ * w_hat\n\nThe \\(\\xi_i \\, \\xi_j\\) terms deliver the following equations\n\n(eq_w_ξξ := Eq(2 * res_w.coeff(ξ, 2), 0).subs(crit).subs(w_ξ, 0).expand())\n\n\\(\\displaystyle \\E_{2} \\hat{w} w_{\\xi\\xi} + \\E_{3} \\hat{w} v^{2} = 0\\)\n\n\nThe above equation should be understood as the following variational problem: find \\(w_{ij} \\in W\\) such that\n\\[\n\\E_2(w_{ij}, \\hat{w}) + \\E_3(v_i, v_j, \\hat{w}) = 0 \\quad \\text{for all} \\quad \\hat{w} \\in W,\n\\]\nwhich defines uniquely the \\(w_{ij}\\). Finally, the \\(\\xi_i \\, \\lambda\\) terms deliver the following variational problem\n\n(eq_w_ξλ := Eq(res_w.coeff(ξ).coeff(λ), 0).subs(crit).subs({w_ξ: 0, w_λ: 0}).expand())\n\n\\(\\displaystyle \\E_{2} \\hat{w} w_{\\xi\\lambda} + \\dot{\\E}_2 \\hat{w} v = 0\\)\n\n\nIn other words: find \\(w_{i\\lambda} \\in W\\) such that \\[\n\\E_2(w_{i\\lambda}, \\hat{w}) + \\dot{\\E}_2(v_i, \\hat{w}) = 0 \\quad \\text{for all} \\quad \\hat{w} \\in W,\n\\] which again defines \\(w_{i\\lambda}\\) uniquely."
  },
  {
    "objectID": "bifurcation_equations.html#sec-20230102030125",
    "href": "bifurcation_equations.html#sec-20230102030125",
    "title": "4  Bifurcation equations",
    "section": "4.3 Elimination of \\(\\lambda\\)",
    "text": "4.3 Elimination of \\(\\lambda\\)\nWe now test Eq. (4.1) with \\(\\hat{v} \\in V\\)\n\\[\n\\E_{,u}[u^\\ast(\\lambda) + \\xi_i \\, v_i + w(\\xi_1, \\ldots, \\xi_m, \\lambda), \\lambda; \\hat{v}] = 0, \\quad \\text{for all} \\quad \\hat{v} \\in W.\n\\tag{4.6}\\]\nThis now defines \\(\\lambda\\) as an implicit function of \\(\\xi_1, \\ldots, \\xi_m\\). The following asymptotic expansion about \\(\\xi_1 = \\cdots = \\xi_m = 0\\) is postulated\n\\[\n\\lambda(\\xi_1, \\ldots, \\xi_m) = \\xi_i \\, \\lambda_i + \\tfrac{1}{2} \\, \\xi_i \\, \\xi_j \\, \\lambda_{ij} + \\ldots\n\\tag{4.7}\\]\nwhere \\(\\lambda_i\\) and \\(\\lambda_{ij}\\) are scalar coefficients to be defined.\n\n\n\n\n\n\nImportant\n\n\n\nAs mentioned above, handling of indicial expressions is a bit awkward in SymPy. Therefore, we define well-formed products such as \\(\\lambda_i \\, \\xi_i\\) or \\(\\lambda_{ij} \\, \\xi_i \\, \\xi_j\\) as fully parenthesized symbols.\nThe auxiliary variable t records the order of each term with respect to the \\(\\xi_1, \\ldots, \\xi_m\\).\n\nt = Symbol(\"t\")\n\n\n\nWe first introduce the asymptotic expansion of \\((\\xi_1, \\ldots, \\xi_m, \\lambda) \\mapsto w(\\xi_1, \\ldots, \\xi_m, \\lambda)\\), \\((\\xi_1, \\ldots, \\xi_m) \\mapsto \\lambda(\\xi_1, \\ldots, \\xi_m)\\) and finally \\((\\xi_1, \\ldots, \\xi_m) \\mapsto u(\\xi_1, \\ldots, \\xi_m)\\) see Eqs. (4.5), (4.7) and (4.2).\n\nw_bif = (t * λ * Symbol(r\"\\bigl(\\xi_k\\,w_{k\\lambda}\\bigr)\") \n         + t **2 / 2 * Symbol(r\"\\bigl(\\xi_i\\,\\xi_j\\,w_{ij}\\bigr)\"))\n\nλ_bif = (t * Symbol(r\"\\bigl(\\xi_{p}\\,\\lambda_{p}\\bigr)\")\n         + t**2 / 2 * Symbol(r\"\\bigl(\\xi_m\\,\\xi_n\\,\\lambda_{mn}\\bigr)\"))\n\nu_bif = u_star + t * Symbol(r\"\\bigl(\\xi_{l}\\,v_{l}\\bigr)\") + w_bif\n\n\n\nCode\nlsk.display_latex_equation(r\"w(\\xi_1, \\ldots, \\xi_m, \\lambda)\", w_bif)\nlsk.display_latex_equation(r\"\\lambda(\\xi_1, \\ldots, \\xi_m)\", λ_bif)\nlsk.display_latex_equation(r\"u(\\xi_1, \\ldots, \\xi_m)\", u_bif)\n\n\n\\(\\displaystyle w(\\xi_1, \\ldots, \\xi_m, \\lambda)=\\frac{\\bigl(\\xi_i\\,\\xi_j\\,w_{ij}\\bigr) t^{2}}{2} + \\bigl(\\xi_k\\,w_{k\\lambda}\\bigr) \\lambda t\\)\n\n\n\\(\\displaystyle \\lambda(\\xi_1, \\ldots, \\xi_m)=\\frac{\\bigl(\\xi_m\\,\\xi_n\\,\\lambda_{mn}\\bigr) t^{2}}{2} + \\bigl(\\xi_{p}\\,\\lambda_{p}\\bigr) t\\)\n\n\n\\(\\displaystyle u(\\xi_1, \\ldots, \\xi_m)=\\frac{\\bigl(\\xi_i\\,\\xi_j\\,w_{ij}\\bigr) t^{2}}{2} + \\bigl(\\xi_k\\,w_{k\\lambda}\\bigr) \\lambda t + \\bigl(\\xi_{l}\\,v_{l}\\bigr) t + \\frac{\\ddddot{u}_0 \\lambda^{4}}{24} + \\frac{\\dddot{u}_0 \\lambda^{3}}{6} + \\frac{\\ddot{u}_0 \\lambda^{2}}{2} + \\dot{u}_0 \\lambda\\)\n\n\nThe above expansions are plugged in the general expression of \\(\\E_{,u}(u, \\lambda; \\bullet)\\) and tested with \\(\\hat{v} \\in V\\), see Eq. (4.6).\n\nres_v = res.subs(u_hat, v_hat).subs(u, u_bif).subs(λ, λ_bif).expand()\n\n\n\n\n\n\n\nNote\n\n\n\nWe used three consecutive subs() rather than one big dictionary substitution for better control on the order of the substitutions. Indeed, we must make sure λ_bif is also plugged into u_bif.\n\n\nWe get an asymptotic expansion of the residual with respect to \\(\\xi_1, \\ldots, \\xi_m\\). This residual must vanish for all \\(\\xi_i\\) sufficiently small. Therefore, all coefficients of the expansion res_v must be nullified at all orders and for all \\(\\xi_i\\) sufficiently small. Consiering the expansion up to third order, we get after simplification only two bifurcation equations, since the terms of order 0 and 1 are identically null.\n\ncoeffs = [simplify_E2(res_v.coeff(t, k)) for k in range(4)]\n    \nassert coeffs[0] == 0\nassert coeffs[1] == 0\n\n\n\nCode\nfor coeff in coeffs[2:]:\n    lsk.display_latex_equation(coeff, 0)\n\n\n\\(\\displaystyle \\frac{\\E_{3} \\bigl(\\xi_{l}\\,v_{l}\\bigr)^{2} \\hat{v}}{2} + \\bigl(\\xi_{l}\\,v_{l}\\bigr) \\bigl(\\xi_{p}\\,\\lambda_{p}\\bigr) \\dot{\\E}_2 \\hat{v}=0\\)\n\n\n\\(\\displaystyle \\frac{\\E_{3} \\bigl(\\xi_i\\,\\xi_j\\,w_{ij}\\bigr) \\bigl(\\xi_{l}\\,v_{l}\\bigr) \\hat{v}}{2} + \\E_{3} \\bigl(\\xi_k\\,w_{k\\lambda}\\bigr) \\bigl(\\xi_{l}\\,v_{l}\\bigr) \\bigl(\\xi_{p}\\,\\lambda_{p}\\bigr) \\hat{v} + \\frac{\\E_{4} \\bigl(\\xi_{l}\\,v_{l}\\bigr)^{3} \\hat{v}}{6} + \\frac{\\bigl(\\xi_i\\,\\xi_j\\,w_{ij}\\bigr) \\bigl(\\xi_{p}\\,\\lambda_{p}\\bigr) \\dot{\\E}_2 \\hat{v}}{2} + \\bigl(\\xi_k\\,w_{k\\lambda}\\bigr) \\bigl(\\xi_{p}\\,\\lambda_{p}\\bigr)^{2} \\dot{\\E}_2 \\hat{v} + \\frac{\\bigl(\\xi_m\\,\\xi_n\\,\\lambda_{mn}\\bigr) \\bigl(\\xi_{l}\\,v_{l}\\bigr) \\dot{\\E}_2 \\hat{v}}{2} + \\frac{\\bigl(\\xi_{l}\\,v_{l}\\bigr)^{2} \\bigl(\\xi_{p}\\,\\lambda_{p}\\bigr) \\dot{\\E}_3 \\hat{v}}{2} + \\frac{\\bigl(\\xi_{l}\\,v_{l}\\bigr) \\bigl(\\xi_{p}\\,\\lambda_{p}\\bigr)^{2} \\ddot{\\E}_2 \\hat{v}}{2}=0\\)\n\n\nThe above bifurcation equations should be understood as Eqs. (4.10) and (4.11) below. Note that these equations are in fact asymptotic expansions. As such, they should hold for all \\(\\xi_1, \\ldots, \\xi_m\\) sufficiently small. Since both equations are homogeneous in \\(\\xi_1, \\ldots, \\xi_m\\), it is equivalent to require these to hold for all \\(\\xi_1, \\ldots, \\xi_m \\in \\reals\\)."
  },
  {
    "objectID": "bifurcation_equations.html#summary",
    "href": "bifurcation_equations.html#summary",
    "title": "4  Bifurcation equations",
    "section": "4.4 Summary",
    "text": "4.4 Summary\nThe bifurcated equilibrium branch is postulated as follows (Lyapunov–Schmidt decomposition) \\[\nu = u^\\ast(\\lambda) + \\xi_i \\, v_i + w, \\quad \\text{with} \\quad w \\in W.\n\\] whith \\(w = w(\\xi_1, \\ldots, \\xi_m) \\in W\\) and \\(\\lambda = \\lambda(\\xi_1, \\ldots, \\xi_m)\\).\nThe Taylor expansion of \\(w\\) reduces to \\[\nw(\\xi_1, \\ldots, \\xi_m, \\lambda) = \\tfrac{1}{2} \\xi_i \\, \\xi_j \\, w_{ij} + \\xi_i \\, \\bigl( \\lambda - \\lambda_0 \\bigr) w_{i\\lambda} + \\cdots,\n\\] where \\(w_{ij}\\) and \\(w_{i\\lambda}\\) are the solutions to the following variational problems \\[\n\\E_2(w_{ij}, \\hat{w}) + \\E_3(v_i, v_j, \\hat{w}) = 0\n\\tag{4.8}\\] and \\[\n\\E_2(w_{i\\lambda}, \\hat{w}) + \\dot{\\E}_2(v_i, \\hat{w}) = 0,\n\\tag{4.9}\\] for all \\(\\hat{w} \\in W\\).\nSimilarly, the Taylor expansion of \\(\\lambda\\) reads \\[\n\\lambda(\\xi_1, \\ldots, \\xi_m) = \\xi_i \\, \\lambda_i + \\tfrac{1}{2} \\, \\xi_i \\, \\xi_j \\, \\lambda_{ij} + \\cdots,\n\\] where \\(\\lambda_i\\) and \\(\\lambda_{ij}\\) are scalar coefficients that solve the following bifurcation equations \\[\n\\xi_j \\, \\xi_k \\, \\bigl[\n\\tfrac{1}{2} \\E_3(v_j, v_k, \\hat{v})\n+ \\lambda_k \\, \\dot{\\E}_2(v_j, \\hat{v})\n\\bigr] = 0\n\\tag{4.10}\\] and \\[\n\\begin{aligned}[b]\n\\xi_j \\, \\xi_k \\, \\xi_l \\, \\bigl[\n\\tfrac{1}{2} \\E_3(v_j, w_{kl}, \\hat{v})\n+ \\lambda_l \\, \\E_3(v_j, w_{k\\lambda}, \\hat{v})\n+ \\tfrac{1}{6} \\E_4(v_j, v_k, v_l, \\hat{v}) &\\\\\n+ \\tfrac{1}{2} \\lambda_l \\, \\dot{\\E}_2(w_{jk}, \\hat{v})\n+ \\lambda_k \\, \\lambda_l \\, \\dot{\\E}_2(w_{j\\lambda}, \\hat{v})\n+ \\tfrac{1}{2} \\lambda_{kl} \\, \\dot{\\E}_2(v_j, \\hat{v}) &\\\\\n+ \\tfrac{1}{2} \\lambda_l \\, \\dot{\\E}_3(v_j, v_k, \\hat{v})\n+ \\tfrac{1}{2} \\lambda_k \\, \\lambda_l \\, \\ddot{\\E}_2(v_j, \\hat{v})\n\\bigr] &= 0,\n\\end{aligned}\n\\tag{4.11}\\] for all \\(\\xi_1, \\ldots, \\xi_m \\in \\reals\\).\n\n\n\n\nChakrabarti, Aditi, Serge Mora, Franck Richard, Ty Phou, Jean-Marc Fromental, Yves Pomeau, and Basile Audoly. 2018. “Selection of Hexagonal Buckling Patterns by the Elastic Rayleigh-Taylor Instability.” Journal of the Mechanics and Physics of Solids 121 (December): 234–57. https://doi.org/10.1016/j.jmps.2018.07.024."
  },
  {
    "objectID": "setting-up_the_mathematical_stage.html#sec-20230208081323",
    "href": "setting-up_the_mathematical_stage.html#sec-20230208081323",
    "title": "2  Setting-up the mathematical stage",
    "section": "2.1 Mathematical setting",
    "text": "2.1 Mathematical setting\nThe space of admissible states of the system under consideration is denoted \\(U\\). It has the structure of a real vector space. The energy of the system is \\(\\E(u, \\lambda)\\), where \\(\\lambda\\) denotes a loading parameter. It is assumed that the fundamental branch of the equilibrium diagram, \\(u^\\ast(\\lambda)\\) is known. Then the energy is stationary with respect to the state \\(u\\) along the whole branch. In other words, for all \\(\\hat{u} \\in U\\) \\[\n\\E_{,u}[u^{\\ast}(\\lambda), \\lambda; \\hat{u}]=0,\n\\tag{2.1}\\] where \\(\\E_{,u}(u, \\lambda; \\hat{u})\\) denotes the (real) value of the differential of the energy \\(\\E\\) with respect to the state \\(u\\), evaluated at \\((u, \\lambda)\\), for the test function \\(\\hat{u}\\). Similarly, evaluation of the second-, third-, etc., order differential of the energy will be denoted \\(\\E_{,uu}(u, \\lambda; \\hat{u}, \\hat{v})\\), \\(\\E_{,uuu}(u, \\lambda; \\hat{u}, \\hat{v}, \\hat{w})\\), etc. It is assumed that a finite value \\(\\lambda_0 > 0\\) of \\(\\lambda\\) can be found (critical load), such that\n\n\\(\\E_{,uu}[u(\\lambda), \\lambda] > 0\\) for all \\(0 < \\lambda < \\lambda_0\\),\n\\(\\E_{,uu}(u_0, \\lambda_0) \\geq 0\\) but \\(\\E_{,uu}(u_0, \\lambda_0) \\ngtr 0\\),\n\\(\\E_{,uu}[u(\\lambda), \\lambda] < 0\\) for \\(\\lambda > \\lambda_0\\), close enough to \\(\\lambda_0\\).\n\nThe load \\(\\lambda_0\\) will be referred to as the critical load; similarly, the state \\(u_0\\) of the system at the critical load will be referred to as the critical state; finally, the pair \\((u_0, \\lambda_0)\\) is the critical point of the system. Assumption 1 implies that equilibria along the fundamental branch are stable below the critical load. Conversely, it results from assumption 3 that equilibrium points on the fundamental branch are unstable above the critical load. Stability at the critical load is yet undetermined.\nThe goal of these notes is to analyze all equilibrium paths that pass through the critical point \\((u_0, \\lambda_0)\\).\nWe introduce the following notations \\[\nu_0 = u^\\ast(\\lambda_0), \\quad \\dot{u}_0 = \\frac{\\D u^\\ast}{\\D \\lambda} \\biggr \\rvert_{\\lambda=\\lambda_0}, \\quad \\ddot{u}_0 = \\frac{\\D^2 u^\\ast}{\\D \\lambda^2} \\biggr \\rvert_{\\lambda=\\lambda_0}, \\quad \\dddot{u}_0 = \\ldots, \\quad \\ddddot{u}_0 = \\ldots\n\\] and \\[\n\\E_2 = \\E_{,uu}(u_0, \\lambda_0), \\quad \\E_3 = \\E_{,uuu}(u_0, \\lambda_0), \\quad \\E_4 = \\E_{,uuuu}(u_0, \\lambda_0).\n\\]\nNote that \\(\\E_2\\), \\(\\E_3\\) and \\(\\E_4\\) thus defined are bi-, tri- and quadrilinear forms, respectively. The following derivatives are also introduced \\[\n\\dot{\\E}_2(\\hat{u}, \\hat{v}) = \\frac{\\D}{\\D\\lambda} \\E_{,uu}[ u^\\ast(\\lambda), \\lambda; \\hat{u}, \\hat{v}] \\biggr \\rvert_{\\lambda = \\lambda_0}\n= \\E_{,uuu}(u_0, \\lambda_0; \\dot{u}_0, \\hat{u}, \\hat{v}) + \\E_{,uu\\lambda}(u_0, \\lambda_0; \\hat{u}, \\hat{v})\n\\tag{2.2}\\] \\[\n\\begin{aligned}[b]\n\\ddot{\\E}_2(\\hat{u}, \\hat{v}) = \\frac{\\D^2}{\\D\\lambda^2} \\E_{,uu}[ u^\\ast(\\lambda), \\lambda; \\hat{u}, \\hat{v}] \\biggr \\rvert_{\\lambda = \\lambda_0}\n={} & \\E_{,uuuu}(u_0, \\lambda_0; \\dot{u}_0, \\dot{u}_0, \\hat{u}, \\hat{v}) + 2\\E_{,uuu\\lambda}(u_0, \\lambda_0; \\dot{u}_0, \\hat{u}, \\hat{v})\\\\\n& + \\E_{,uu\\lambda\\lambda}( u_0, \\lambda_0; \\hat{u}, \\hat{v}) + \\E_{,uuu}(u_0, \\lambda_0, \\ddot{u}_0),\n\\end{aligned}\n\\] and, similarly, \\(\\dot{\\E}_3\\), \\(\\ddot{\\E}_3\\), etc."
  },
  {
    "objectID": "setting-up_the_mathematical_stage.html#sec-20230107173921",
    "href": "setting-up_the_mathematical_stage.html#sec-20230107173921",
    "title": "2  Setting-up the mathematical stage",
    "section": "2.2 Kernel of the hessian of the energy",
    "text": "2.2 Kernel of the hessian of the energy\nThe kernel of the hessian of the energy, \\(\\E_2\\), is defined as follows \\[\nV = \\bigl\\{ u \\in U, \\E_2(u, u) = 0 \\bigr\\}.\n\\]\nSince \\(\\E_2\\) is a bilinear, symmetric and positive (but not poitive definite!) form, \\(V\\) is a vector subspace of \\(U\\).\nTo prove this result, we must show that, for all \\(u, v \\in V\\) and \\(\\alpha \\in \\reals\\), \\(w = u + \\alpha \\, v \\in V\\). From the bilinearity and symmetry of \\(\\E_2\\) \\[\n\\E_2(w, w) = \\E_2(u + \\alpha \\, v, u + \\alpha \\, v) = \\E_2(u, u) + 2\\alpha \\, \\E_2(u, v) + \\alpha^2 \\, \\E_2(v, v),\n\\]\nSince \\(u, v \\in \\ker\\E_2\\), the first and the last term vanish, and the above identity reduces to \\[\n\\E_2(w, w) = 2\\alpha \\, \\E_2(u, v)\n\\]\nThe bilinear form \\(\\E_2\\) is positive, therefore the left-hand side is positive, for all values of \\(\\alpha \\in \\reals\\). The quantity \\(\\E_2(u, v) = 0\\) is necessarily null, and \\(\\E_2(w, w) = 0\\), which proves that \\(w \\in V\\) and that \\(V\\) is a vector subspace of \\(U\\). The following characterization of \\(V\\) holds \\[\nv \\in V \\quad \\iff \\quad \\E_2(v, \\hat{u}) = 0 \\quad \\text{for all} \\quad \\hat{u} \\in U.\n\\tag{2.3}\\]\nIndeed, if for all \\(\\hat{u} \\in U\\), \\(\\E_2(v, \\hat{u}) = 0\\), then in particular \\(\\E_2(v, v) = 0\\) and \\(v \\in V\\). Conversely, let \\(v \\in V\\), \\(\\hat{u} \\in U\\) and \\(\\alpha \\in \\reals\\). Similarly to the previous proof, we write that \\(\\E_2(w, w) \\geq 0\\), with \\(w = \\hat{u} + \\alpha \\, v\\) \\[\n\\E_2(w, w) = \\E_2(\\hat{u}, \\hat{u}) + 2\\alpha \\, \\E_2(\\hat{u}, v) + \\alpha^2 \\, \\E_2(v, v) = 2\\alpha \\, \\E_2(\\hat{u}, v) + \\E_2(\\hat{u}, \\hat{u}) \\geq 0,\n\\] (\\(\\E_2(v, v) = 0\\) since \\(v \\in V\\)). The above expression is of degree 1 in \\(\\alpha\\), with a constant sign. Therefore the linear term in \\(\\alpha\\) must vanish: \\(\\E_2(\\hat{u}, v) = 0\\), which proves the characterization (2.3) of \\(V\\).\nIt will be assumed in the remainder of these notes the dimension of \\(V\\) is finite: \\(m = \\dim V < +\\infty\\); \\(m\\) is the multiplicity of the critical point. A (finite) basis \\((v_1, \\ldots, v_m)\\) of \\(V\\) can therefore be introduced, that is orthonormal in the sense of \\(\\langle \\bullet, \\bullet \\rangle\\) \\[\n\\langle v_i, v_j \\rangle = \\delta_{ij} \\quad \\text{for all} \\quad i, j = 1, \\ldots, m.\n\\]\nTo close this section, we define the complementary subspace \\(W\\), orthogonal to \\(V\\) for the scalar product \\(\\langle \\bullet, \\bullet \\rangle\\) \\[\nU = V \\overset{\\perp}{\\otimes} W \\quad \\text{and} \\quad \\langle \\hat{v}, \\hat{w} \\rangle = 0 \\quad \\text{for all} \\quad \\hat{v} \\in V \\quad \\text{and} \\quad \\hat{w} \\in W.\n\\]\n\n\n\n\n\n\nNote\n\n\n\nThe bilinear form \\(\\E_2\\) is elliptic over \\(W\\). Therefore, variational problems of the type: find \\(w \\in W\\) such that \\[\n\\E_2(w, \\hat{w})+\\ell(\\hat{w}) = 0 \\quad \\text{for all} \\quad \\hat{w} \\in W\n\\] are well-posed for any linear form \\(\\ell\\) over \\(W\\). In particular, for \\(\\ell=0\\), the unique solution to the variational problem \\[\n\\E_2(w, \\hat{w}) = 0 \\quad \\text{for all} \\quad \\hat{w} \\in W\n\\] is \\(w = 0\\)."
  },
  {
    "objectID": "problem_setting.html#computational-setting",
    "href": "problem_setting.html#computational-setting",
    "title": "3  Setting up the computational stage",
    "section": "3.1 Computational setting",
    "text": "3.1 Computational setting\nWe will use the Python library SymPy for symbolic mathematics and rely also on the IPython library (in particular, IPython.display.Math) for pretty \\(\\LaTeX\\) output. Some useful functions are defined in the lsk.py module, which will be systematically imported.\nWithout loss of generality, it will be assumed in all symbolic calculations that \\(\\lambda_0 = 0\\) and \\(u_0 = 0\\). The general case \\(\\lambda_0 \\neq 0\\) and \\(u_0 \\neq 0\\) is readily recovered through the substitution \\(\\lambda \\leftrightarrow \\lambda - \\lambda_0\\) and \\(u \\leftrightarrow u - u_0\\).\nThe following developments involve the energy \\((u, \\lambda) \\mapsto \\E(u, \\lambda)\\) and its differentials at the critical point \\((u_0, \\lambda_0)\\), as well as the fundamental path \\(\\lambda \\mapsto u^\\ast(\\lambda)\\) and its derivatives at \\(\\lambda = \\lambda_0\\). It will therefore be convenient to express \\(\\E\\) and \\(u^\\star\\) as Taylor expansions with respect to \\(u\\) and \\(\\lambda\\).\nWe start with the Taylor expansion of the energy \\(\\E\\). We define its differentials at the critical point. These differentials are stored in a dictionary. Values are indexed with the order of the differentials with respect to \\(u\\) and \\(\\lambda\\).\n\n\n\n\n\n\nNote\n\n\n\nIn the following code blocks, n is the total order of the differential, p is the order of the differential with respect to \\(u\\) and q = n - p is the order of the differential with respect to \\(\\lambda\\).\n\n\n\nfrom sympy import *\n\n\n\n\n\n\n\nWarning\n\n\n\nThe above statement is extremely poor practice. We need it as sympy.srepr automatically drops the namespace. For example\n\nimport sympy.abc\nsrepr(sympy.abc.a + sympy.abc.b)\n\n\"Add(Symbol('a'), Symbol('b'))\"\n\n\nTherefore, in order to eval strings produced by sympy.srepr, as will be done in subsequent chapters, we will need all SymPy object to live in the global namespace.\n\n\n\nimport lsk\n\nλ, u, v, u_hat, v_hat, w_hat = sympy.symbols(r\"\\lambda u v \\hat{u} \\hat{v} \\hat{w}\")\n\n\ndE = dict()\nfor n in range(1, 5):\n    for p in range(n + 1):\n        q = n - p\n        if q == 0:\n            dE[p, q] = Symbol(r\"\\E_{}\".format(p))\n        else:\n            dE[p, q] = Symbol(r\"\\E_{\" + p * \"u\" + q * \"\\lambda\" + \"}\")\n            \n# Remember that the energy is stationary at the critical point (equilibrium)\ndE[1, 0] = Number(0)\n\nThe dictionary dE should be understood as follows: dE[(2, 1)] == dE[2, 1] is the symbol \\(\\E_{uu\\lambda}\\), which stands for \\(\\E_{,uu\\lambda}(u_0, \\lambda_0; \\bullet, \\bullet)\\). The following symbols have been defined.\n\n\nCode\n_dict = dict()\nfor n in range(1, 5):\n    for p in range(n + 1):\n        q = n - p\n        _dict[dE[p, q]] = (\"\\\\E_{,\" + p * \"u\" \n                           + q * \"\\\\lambda\"\n                           + \"}(u_0, \\lambda_0)\")\n        \nlsk.display_latex_dict(_dict, num_cols=3)\n\n\n\\(\\displaystyle \\begin{align}\\E_{\\lambda}&=\\E_{,\\lambda}(u_0, \\lambda_0)&0&=\\E_{,u}(u_0, \\lambda_0)&\\E_{\\lambda\\lambda}&=\\E_{,\\lambda\\lambda}(u_0, \\lambda_0)\\\\\\E_{u\\lambda}&=\\E_{,u\\lambda}(u_0, \\lambda_0)&\\E_{2}&=\\E_{,uu}(u_0, \\lambda_0)&\\E_{\\lambda\\lambda\\lambda}&=\\E_{,\\lambda\\lambda\\lambda}(u_0, \\lambda_0)\\\\\\E_{u\\lambda\\lambda}&=\\E_{,u\\lambda\\lambda}(u_0, \\lambda_0)&\\E_{uu\\lambda}&=\\E_{,uu\\lambda}(u_0, \\lambda_0)&\\E_{3}&=\\E_{,uuu}(u_0, \\lambda_0)\\\\\\E_{\\lambda\\lambda\\lambda\\lambda}&=\\E_{,\\lambda\\lambda\\lambda\\lambda}(u_0, \\lambda_0)&\\E_{u\\lambda\\lambda\\lambda}&=\\E_{,u\\lambda\\lambda\\lambda}(u_0, \\lambda_0)&\\E_{uu\\lambda\\lambda}&=\\E_{,uu\\lambda\\lambda}(u_0, \\lambda_0)\\\\\\E_{uuu\\lambda}&=\\E_{,uuu\\lambda}(u_0, \\lambda_0)&\\E_{4}&=\\E_{,uuuu}(u_0, \\lambda_0)&\\end{align}\\)\n\n\nwhere\n\n\\(\\E_\\lambda\\), \\(\\E_{\\lambda\\lambda}\\), \\(\\E_{\\lambda\\lambda\\lambda}\\) and \\(\\E_{\\lambda\\lambda\\lambda\\lambda}\\) are scalar quantities,\n\\(\\E_{u\\lambda}\\), \\(\\E_{u\\lambda\\lambda}\\) and \\(\\E_{u\\lambda\\lambda\\lambda}\\) are linear forms,\n\\(\\E_2\\), \\(\\E_{uu\\lambda}\\) and \\(\\E_{uu\\lambda\\lambda}\\) are bilinear forms,\n\\(\\E_3\\) and \\(\\E_{uuu\\lambda}\\) are trilinear forms,\n\\(\\E_4\\) is a quadrilinear form.\n\n\n\n\n\n\n\nImportant\n\n\n\nNote that all these differentials are defined as SymPy scalars. A definition as a SymPy function (e.g. E2 = Function(r\"\\E_2\")) would be more appropriate. However, SymPy would fail to account for multilinearity or symmetry of these forms. Therefore, we use the following trick: all multi-linear forms are defined as scalars, and the standard multiplication operator * means function application. In other words, E2 * (α * u + β * v) * w (resp. E2 * u * v - E2 * v * u) should be understood as E2(α * u + β * v, w) (resp. E2(u, v) - E2(v, u)). In both cases, the expressions would are correctly simplified.\nWhether the symbols in an expression are true scalars or vectors (elements of \\(U\\)) should be clear from the context. For example, in the expression: λ * E2 * u * v, the first * is a true multiplication, while the other * refer to function application.\n\n\nThe energy \\(\\E(u, \\lambda)\\) is now expressed as a Taylor expansion about the critical point.\n\n_f = lambda p, q: binomial(p + q, p) / factorial(p + q)\nE = sum(_f(p, q) * dE_pq * u**p * λ**q for (p, q), dE_pq in dE.items())\n\n\n\nCode\nlsk.display_latex_equation(r\"\\E(u, \\lambda)\", E)\n\n\n\\(\\displaystyle \\E(u, \\lambda)=\\frac{\\E_{2} u^{2}}{2} + \\frac{\\E_{3} u^{3}}{6} + \\frac{\\E_{4} u^{4}}{24} + \\frac{\\E_{\\lambda\\lambda\\lambda\\lambda} \\lambda^{4}}{24} + \\frac{\\E_{\\lambda\\lambda\\lambda} \\lambda^{3}}{6} + \\frac{\\E_{\\lambda\\lambda} \\lambda^{2}}{2} + \\E_{\\lambda} \\lambda + \\frac{\\E_{u\\lambda\\lambda\\lambda} \\lambda^{3} u}{6} + \\frac{\\E_{u\\lambda\\lambda} \\lambda^{2} u}{2} + \\E_{u\\lambda} \\lambda u + \\frac{\\E_{uu\\lambda\\lambda} \\lambda^{2} u^{2}}{4} + \\frac{\\E_{uu\\lambda} \\lambda u^{2}}{2} + \\frac{\\E_{uuu\\lambda} \\lambda u^{3}}{6}\\)\n\n\nWe now turn to the definition of the fundamental path \\(\\lambda \\mapsto u^\\star(\\lambda)\\). We first define in a dictionary the derivatives of \\(u^\\star\\) with respect to \\(\\lambda\\), at \\(\\lambda = \\lambda_0 = 0\\). For example, du_0[2] is the symbol \\(\\ddot{u}_0\\), which stands for \\(\\D^2 u^\\star / \\D \\lambda^2 \\rvert_{\\lambda=\\lambda_0}\\).\n\ndu_0 = {n: Symbol(\"\\\\\" + \"\".join(n * (\"d\",)) + \"ot{u}_0\") for n in range(1, 5)}\n\n_dict = {f\"\\\\frac{{\\\\D^{k}u^\\\\ast}}{{\\\\D \\\\lambda^{k}}}\" : v for k, v in du_0.items()}\n\n\n\nCode\nlsk.display_latex_dict(_dict, num_cols=4)\n\n\n\\(\\displaystyle \\begin{align}\\frac{\\D^1u^\\ast}{\\D \\lambda^1}&=\\dot{u}_0&\\frac{\\D^2u^\\ast}{\\D \\lambda^2}&=\\ddot{u}_0&\\frac{\\D^3u^\\ast}{\\D \\lambda^3}&=\\dddot{u}_0&\\frac{\\D^4u^\\ast}{\\D \\lambda^4}&=\\ddddot{u}_0\\\\\\end{align}\\)\n\n\nThe fundamental path is then defined through its Taylor expansion.\n\nu_star = sum(λ**n / factorial(n) * v for n, v in du_0.items())\n\n\n\nCode\nlsk.display_latex_equation(r\"u^\\star(\\lambda)\", u_star)\n\n\n\\(\\displaystyle u^\\star(\\lambda)=\\frac{\\ddddot{u}_0 \\lambda^{4}}{24} + \\frac{\\dddot{u}_0 \\lambda^{3}}{6} + \\frac{\\ddot{u}_0 \\lambda^{2}}{2} + \\dot{u}_0 \\lambda\\)"
  },
  {
    "objectID": "setting-up_the_computational_stage.html#sec-20230103084732",
    "href": "setting-up_the_computational_stage.html#sec-20230103084732",
    "title": "3  Setting-up the computational stage",
    "section": "3.1 Importing Sympy",
    "text": "3.1 Importing Sympy\nWe will use the Python library SymPy for symbolic mathematics and rely also on the IPython library (in particular, IPython.display.Math) for pretty \\(\\LaTeX\\) output. Some useful functions are defined in the lsk.py module, which will be systematically imported.\nWithout loss of generality, it will be assumed in all symbolic calculations that \\(\\lambda_0 = 0\\) and \\(u_0 = 0\\). The general case \\(\\lambda_0 \\neq 0\\) and \\(u_0 \\neq 0\\) is readily recovered through the substitution \\(\\lambda \\leftrightarrow \\lambda - \\lambda_0\\) and \\(u \\leftrightarrow u - u_0\\).\nThe following developments involve the energy \\((u, \\lambda) \\mapsto \\E(u, \\lambda)\\) and its differentials at the critical point \\((u_0, \\lambda_0)\\), as well as the fundamental path \\(\\lambda \\mapsto u^\\ast(\\lambda)\\) and its derivatives at \\(\\lambda = \\lambda_0\\). It will therefore be convenient to express \\(\\E\\) and \\(u^\\star\\) as Taylor expansions with respect to \\(u\\) and \\(\\lambda\\).\nWe start with the Taylor expansion of the energy \\(\\E\\). We define its differentials at the critical point. These differentials are stored in a dictionary. Values are indexed with the order of the differentials with respect to \\(u\\) and \\(\\lambda\\).\n\n\n\n\n\n\nNote\n\n\n\nIn the following code blocks, n is the total order of the differential, p is the order of the differential with respect to \\(u\\) and q = n - p is the order of the differential with respect to \\(\\lambda\\).\n\n\n\nfrom sympy import *\n\n\n\n\n\n\n\nWarning\n\n\n\nThe above statement is extremely poor practice. We need it as sympy.srepr automatically drops the namespace. For example\n\nimport sympy.abc\nsrepr(sympy.abc.a + sympy.abc.b)\n\n\"Add(Symbol('a'), Symbol('b'))\"\n\n\nTherefore, in order to eval strings produced by sympy.srepr, as will be done in subsequent chapters, we will need all SymPy object to live in the global namespace.\n\n\n\nimport lsk\n\nλ, u, v, u_hat, v_hat, w_hat = sympy.symbols(r\"\\lambda u v \\hat{u} \\hat{v} \\hat{w}\")\n\n\ndE = dict()\nfor n in range(1, 5):\n    for p in range(n + 1):\n        q = n - p\n        if q == 0:\n            dE[p, q] = Symbol(r\"\\E_{}\".format(p))\n        else:\n            dE[p, q] = Symbol(r\"\\E_{\" + p * \"u\" + q * \"\\lambda\" + \"}\")\n            \n# Remember that the energy is stationary at the critical point (equilibrium)\ndE[1, 0] = Number(0)\n\nThe dictionary dE should be understood as follows: dE[(2, 1)] == dE[2, 1] is the symbol \\(\\E_{uu\\lambda}\\), which stands for \\(\\E_{,uu\\lambda}(u_0, \\lambda_0; \\bullet, \\bullet)\\). The following symbols have been defined.\n\n\nCode\n_dict = dict()\nfor n in range(1, 5):\n    for p in range(n + 1):\n        q = n - p\n        _dict[dE[p, q]] = (\"\\\\E_{,\" + p * \"u\" \n                           + q * \"\\\\lambda\"\n                           + \"}(u_0, \\lambda_0)\")\n        \nlsk.display_latex_dict(_dict, num_cols=3)\n\n\n\\(\\displaystyle \\begin{align}\\E_{\\lambda}&=\\E_{,\\lambda}(u_0, \\lambda_0)&0&=\\E_{,u}(u_0, \\lambda_0)&\\E_{\\lambda\\lambda}&=\\E_{,\\lambda\\lambda}(u_0, \\lambda_0)\\\\\\E_{u\\lambda}&=\\E_{,u\\lambda}(u_0, \\lambda_0)&\\E_{2}&=\\E_{,uu}(u_0, \\lambda_0)&\\E_{\\lambda\\lambda\\lambda}&=\\E_{,\\lambda\\lambda\\lambda}(u_0, \\lambda_0)\\\\\\E_{u\\lambda\\lambda}&=\\E_{,u\\lambda\\lambda}(u_0, \\lambda_0)&\\E_{uu\\lambda}&=\\E_{,uu\\lambda}(u_0, \\lambda_0)&\\E_{3}&=\\E_{,uuu}(u_0, \\lambda_0)\\\\\\E_{\\lambda\\lambda\\lambda\\lambda}&=\\E_{,\\lambda\\lambda\\lambda\\lambda}(u_0, \\lambda_0)&\\E_{u\\lambda\\lambda\\lambda}&=\\E_{,u\\lambda\\lambda\\lambda}(u_0, \\lambda_0)&\\E_{uu\\lambda\\lambda}&=\\E_{,uu\\lambda\\lambda}(u_0, \\lambda_0)\\\\\\E_{uuu\\lambda}&=\\E_{,uuu\\lambda}(u_0, \\lambda_0)&\\E_{4}&=\\E_{,uuuu}(u_0, \\lambda_0)&\\end{align}\\)\n\n\nwhere\n\n\\(\\E_\\lambda\\), \\(\\E_{\\lambda\\lambda}\\), \\(\\E_{\\lambda\\lambda\\lambda}\\) and \\(\\E_{\\lambda\\lambda\\lambda\\lambda}\\) are scalar quantities,\n\\(\\E_{u\\lambda}\\), \\(\\E_{u\\lambda\\lambda}\\) and \\(\\E_{u\\lambda\\lambda\\lambda}\\) are linear forms,\n\\(\\E_2\\), \\(\\E_{uu\\lambda}\\) and \\(\\E_{uu\\lambda\\lambda}\\) are bilinear forms,\n\\(\\E_3\\) and \\(\\E_{uuu\\lambda}\\) are trilinear forms,\n\\(\\E_4\\) is a quadrilinear form.\n\n\n\n\n\n\n\nImportant\n\n\n\nNote that all these differentials are defined as SymPy scalars. A definition as a SymPy function (e.g. E2 = Function(r\"\\E_2\")) would be more appropriate. However, SymPy would fail to account for multilinearity or symmetry of these forms. Therefore, we use the following trick: all multi-linear forms are defined as scalars, and the standard multiplication operator * means function application. In other words, E2 * (α * u + β * v) * w (resp. E2 * u * v - E2 * v * u) should be understood as E2(α * u + β * v, w) (resp. E2(u, v) - E2(v, u)). In both cases, the expressions would are correctly simplified.\nWhether the symbols in an expression are true scalars or vectors (elements of \\(U\\)) should be clear from the context. For example, in the expression: λ * E2 * u * v, the first * is a true multiplication, while the other * refer to function application.\n\n\nThe energy \\(\\E(u, \\lambda)\\) is now expressed as a Taylor expansion about the critical point.\n\n_f = lambda p, q: binomial(p + q, p) / factorial(p + q)\nE = sum(_f(p, q) * dE_pq * u**p * λ**q for (p, q), dE_pq in dE.items())\n\n\n\nCode\nlsk.display_latex_equation(r\"\\E(u, \\lambda)\", E)\n\n\n\\(\\displaystyle \\E(u, \\lambda)=\\frac{\\E_{2} u^{2}}{2} + \\frac{\\E_{3} u^{3}}{6} + \\frac{\\E_{4} u^{4}}{24} + \\frac{\\E_{\\lambda\\lambda\\lambda\\lambda} \\lambda^{4}}{24} + \\frac{\\E_{\\lambda\\lambda\\lambda} \\lambda^{3}}{6} + \\frac{\\E_{\\lambda\\lambda} \\lambda^{2}}{2} + \\E_{\\lambda} \\lambda + \\frac{\\E_{u\\lambda\\lambda\\lambda} \\lambda^{3} u}{6} + \\frac{\\E_{u\\lambda\\lambda} \\lambda^{2} u}{2} + \\E_{u\\lambda} \\lambda u + \\frac{\\E_{uu\\lambda\\lambda} \\lambda^{2} u^{2}}{4} + \\frac{\\E_{uu\\lambda} \\lambda u^{2}}{2} + \\frac{\\E_{uuu\\lambda} \\lambda u^{3}}{6}\\)\n\n\nWe now turn to the definition of the fundamental path \\(\\lambda \\mapsto u^\\star(\\lambda)\\). We first define in a dictionary the derivatives of \\(u^\\star\\) with respect to \\(\\lambda\\), at \\(\\lambda = \\lambda_0 = 0\\). For example, du_0[2] is the symbol \\(\\ddot{u}_0\\), which stands for \\(\\D^2 u^\\star / \\D \\lambda^2 \\rvert_{\\lambda=\\lambda_0}\\).\n\ndu_0 = {n: Symbol(\"\\\\\" + \"\".join(n * (\"d\",)) + \"ot{u}_0\") for n in range(1, 5)}\n\n_dict = {f\"\\\\frac{{\\\\D^{k}u^\\\\ast}}{{\\\\D \\\\lambda^{k}}}\" : v for k, v in du_0.items()}\n\n\n\nCode\nlsk.display_latex_dict(_dict, num_cols=4)\n\n\n\\(\\displaystyle \\begin{align}\\frac{\\D^1u^\\ast}{\\D \\lambda^1}&=\\dot{u}_0&\\frac{\\D^2u^\\ast}{\\D \\lambda^2}&=\\ddot{u}_0&\\frac{\\D^3u^\\ast}{\\D \\lambda^3}&=\\dddot{u}_0&\\frac{\\D^4u^\\ast}{\\D \\lambda^4}&=\\ddddot{u}_0\\\\\\end{align}\\)\n\n\nThe fundamental path is then defined through its Taylor expansion.\n\nu_star = sum(λ**n / factorial(n) * v for n, v in du_0.items())\n\n\n\nCode\nlsk.display_latex_equation(r\"u^\\star(\\lambda)\", u_star)\n\n\n\\(\\displaystyle u^\\star(\\lambda)=\\frac{\\ddddot{u}_0 \\lambda^{4}}{24} + \\frac{\\dddot{u}_0 \\lambda^{3}}{6} + \\frac{\\ddot{u}_0 \\lambda^{2}}{2} + \\dot{u}_0 \\lambda\\)"
  },
  {
    "objectID": "setting-up_the_computational_stage.html#sec-20230208081549",
    "href": "setting-up_the_computational_stage.html#sec-20230208081549",
    "title": "3  Setting-up the computational stage",
    "section": "3.2 Elimination of the mixed derivatives of the energy",
    "text": "3.2 Elimination of the mixed derivatives of the energy\nSince the fundamental path \\(\\lambda \\mapsto u^\\ast(\\lambda)\\) is an equilibrium path, the various differentials of the energy at the critical point are not linearly independent. To express the relationships between these forms, we define \\(\\mathcal R^\\ast(\\lambda; \\bullet)\\) as the jacobian of the energy along the fundamental path \\(u^\\ast(\\lambda)\\) \\[\n\\mathcal R^\\ast(\\lambda; \\bullet) = \\E_{,u}[u^\\ast(\\lambda), \\lambda; \\bullet].\n\\]\n\nR_star = (E.diff(u) * u_hat).subs(u, u_star).expand()\n\n\n\nCode\nlsk.display_latex_equation(r\"\\mathcal{R}^\\ast(\\lambda;\" + sympy.latex(u_hat) + \")\",\n                           R_star.series(λ, 0, 5))\n\n\n\\(\\displaystyle \\mathcal{R}^\\ast(\\lambda;\\hat{u})=\\lambda \\left(\\E_{2} \\dot{u}_0 \\hat{u} + \\E_{u\\lambda} \\hat{u}\\right) + \\lambda^{2} \\left(\\frac{\\E_{2} \\ddot{u}_0 \\hat{u}}{2} + \\frac{\\E_{3} \\dot{u}_0^{2} \\hat{u}}{2} + \\frac{\\E_{u\\lambda\\lambda} \\hat{u}}{2} + \\E_{uu\\lambda} \\dot{u}_0 \\hat{u}\\right) + \\lambda^{3} \\left(\\frac{\\E_{2} \\dddot{u}_0 \\hat{u}}{6} + \\frac{\\E_{3} \\ddot{u}_0 \\dot{u}_0 \\hat{u}}{2} + \\frac{\\E_{4} \\dot{u}_0^{3} \\hat{u}}{6} + \\frac{\\E_{u\\lambda\\lambda\\lambda} \\hat{u}}{6} + \\frac{\\E_{uu\\lambda\\lambda} \\dot{u}_0 \\hat{u}}{2} + \\frac{\\E_{uu\\lambda} \\ddot{u}_0 \\hat{u}}{2} + \\frac{\\E_{uuu\\lambda} \\dot{u}_0^{2} \\hat{u}}{2}\\right) + \\lambda^{4} \\left(\\frac{\\E_{2} \\ddddot{u}_0 \\hat{u}}{24} + \\frac{\\E_{3} \\dddot{u}_0 \\dot{u}_0 \\hat{u}}{6} + \\frac{\\E_{3} \\ddot{u}_0^{2} \\hat{u}}{8} + \\frac{\\E_{4} \\ddot{u}_0 \\dot{u}_0^{2} \\hat{u}}{4} + \\frac{\\E_{uu\\lambda\\lambda} \\ddot{u}_0 \\hat{u}}{4} + \\frac{\\E_{uu\\lambda} \\dddot{u}_0 \\hat{u}}{6} + \\frac{\\E_{uuu\\lambda} \\ddot{u}_0 \\dot{u}_0 \\hat{u}}{2}\\right) + O\\left(\\lambda^{5}\\right)\\)\n\n\nOf course, since \\(\\lambda \\mapsto u^\\ast(\\lambda)\\) is an equilibrium path, we have \\(\\mathcal R^\\ast(\\lambda; \\bullet) = 0\\) for all \\(\\lambda\\). Therefore, all coefficients of the above polynomial in \\(\\lambda\\) are null, which delivers expressions of \\(\\E_{u\\lambda}\\), \\(\\E_{u\\lambda\\lambda}\\) and \\(\\E_{u\\lambda\\lambda\\lambda}\\)\n\nmixed1 = dict()\n\nfor q in range(1, 4):\n    x = dE[1, q]\n    eq = R_star.coeff(λ, q)\n    sol = solve(eq, x)[0]\n    mixed1[x] = sol\n\n\n\nCode\nlsk.display_latex_dict(mixed1, num_cols=1)\n\n\n\\(\\displaystyle \\begin{align}\\E_{u\\lambda}&=- \\E_{2} \\dot{u}_0\\\\\\E_{u\\lambda\\lambda}&=- \\E_{2} \\ddot{u}_0 - \\E_{3} \\dot{u}_0^{2} - 2 \\E_{uu\\lambda} \\dot{u}_0\\\\\\E_{u\\lambda\\lambda\\lambda}&=- \\E_{2} \\dddot{u}_0 - 3 \\E_{3} \\ddot{u}_0 \\dot{u}_0 - \\E_{4} \\dot{u}_0^{3} - 3 \\E_{uu\\lambda\\lambda} \\dot{u}_0 - 3 \\E_{uu\\lambda} \\ddot{u}_0 - 3 \\E_{uuu\\lambda} \\dot{u}_0^{2}\\\\\\end{align}\\)\n\n\nWe want to get rid of the remaining mixed derivatives, namely: \\(\\E_{uu\\lambda}\\), \\(\\E_{uuu\\lambda}\\) and \\(\\E_{uu\\lambda\\lambda}\\). To do so, we introduce the derivatives \\(\\dot{\\E}_2\\), \\(\\ddot{\\E}_2\\) and \\(\\dot{\\E}_3\\) defined in ?sec-20230105101657.\n\nE2_dot, E2_ddot, E3_dot = sympy.symbols(\"\\dot{\\E}_2 \\ddot{\\E}_2 \\dot{\\E}_3\")\n\nE_uu_star = E.diff(u, 2).subs(u, u_star).expand()\nE_uuu_star = E.diff(u, 3).subs(u, u_star).expand()\n\neqs = [Eq(E2_dot, E_uu_star.coeff(λ, 1)),\n       Eq(E3_dot, E_uuu_star.coeff(λ, 1)),\n       Eq(E2_ddot, 2 * E_uu_star.coeff(λ, 2))]\n\nunknowns = [dE[2, 1], dE[3, 1], dE[2, 2]] # E_uuλ, E_uuuλ, E_uuλλ\n\nmixed2 = dict()\nfor eq, x in zip(eqs, unknowns):\n    mixed2[x] = solve(eq, x)[0].subs(mixed2).expand()\n\nWe get the following expressions\n\n\nCode\nlsk.display_latex_dict(mixed2, num_cols=1)\n\n\n\\(\\displaystyle \\begin{align}\\E_{uu\\lambda}&=- \\E_{3} \\dot{u}_0 + \\dot{\\E}_2\\\\\\E_{uuu\\lambda}&=- \\E_{4} \\dot{u}_0 + \\dot{\\E}_3\\\\\\E_{uu\\lambda\\lambda}&=- \\E_{3} \\ddot{u}_0 + \\E_{4} \\dot{u}_0^{2} + \\ddot{\\E}_2 - 2 \\dot{\\E}_3 \\dot{u}_0\\\\\\end{align}\\)\n\n\nCombining the above results allows to fully eliminate the mixed derivatives\n\n\nCode\nmixed = {k: v.subs(mixed2).expand() for k, v in mixed1.items()}\nmixed.update(mixed2)\n\nlsk.display_latex_dict(mixed, num_cols=1)\n\n\n\\(\\displaystyle \\begin{align}\\E_{u\\lambda}&=- \\E_{2} \\dot{u}_0\\\\\\E_{u\\lambda\\lambda}&=- \\E_{2} \\ddot{u}_0 + \\E_{3} \\dot{u}_0^{2} - 2 \\dot{\\E}_2 \\dot{u}_0\\\\\\E_{u\\lambda\\lambda\\lambda}&=- \\E_{2} \\dddot{u}_0 + 3 \\E_{3} \\ddot{u}_0 \\dot{u}_0 - \\E_{4} \\dot{u}_0^{3} - 3 \\ddot{\\E}_2 \\dot{u}_0 - 3 \\ddot{u}_0 \\dot{\\E}_2 + 3 \\dot{\\E}_3 \\dot{u}_0^{2}\\\\\\E_{uu\\lambda}&=- \\E_{3} \\dot{u}_0 + \\dot{\\E}_2\\\\\\E_{uuu\\lambda}&=- \\E_{4} \\dot{u}_0 + \\dot{\\E}_3\\\\\\E_{uu\\lambda\\lambda}&=- \\E_{3} \\ddot{u}_0 + \\E_{4} \\dot{u}_0^{2} + \\ddot{\\E}_2 - 2 \\dot{\\E}_3 \\dot{u}_0\\\\\\end{align}\\)\n\n\nThese expressions can be plugged into the expansion of the energy.\n\nE = E.subs(mixed).expand()\n\n\n\nCode\nlsk.display_latex_equation(r\"\\E(u, \\lambda)\", E)\n\n\n\\(\\displaystyle \\E(u, \\lambda)=- \\frac{\\E_{2} \\dddot{u}_0 \\lambda^{3} u}{6} - \\frac{\\E_{2} \\ddot{u}_0 \\lambda^{2} u}{2} - \\E_{2} \\dot{u}_0 \\lambda u + \\frac{\\E_{2} u^{2}}{2} + \\frac{\\E_{3} \\ddot{u}_0 \\dot{u}_0 \\lambda^{3} u}{2} - \\frac{\\E_{3} \\ddot{u}_0 \\lambda^{2} u^{2}}{4} + \\frac{\\E_{3} \\dot{u}_0^{2} \\lambda^{2} u}{2} - \\frac{\\E_{3} \\dot{u}_0 \\lambda u^{2}}{2} + \\frac{\\E_{3} u^{3}}{6} - \\frac{\\E_{4} \\dot{u}_0^{3} \\lambda^{3} u}{6} + \\frac{\\E_{4} \\dot{u}_0^{2} \\lambda^{2} u^{2}}{4} - \\frac{\\E_{4} \\dot{u}_0 \\lambda u^{3}}{6} + \\frac{\\E_{4} u^{4}}{24} + \\frac{\\E_{\\lambda\\lambda\\lambda\\lambda} \\lambda^{4}}{24} + \\frac{\\E_{\\lambda\\lambda\\lambda} \\lambda^{3}}{6} + \\frac{\\E_{\\lambda\\lambda} \\lambda^{2}}{2} + \\E_{\\lambda} \\lambda - \\frac{\\ddot{\\E}_2 \\dot{u}_0 \\lambda^{3} u}{2} + \\frac{\\ddot{\\E}_2 \\lambda^{2} u^{2}}{4} - \\frac{\\ddot{u}_0 \\dot{\\E}_2 \\lambda^{3} u}{2} - \\dot{\\E}_2 \\dot{u}_0 \\lambda^{2} u + \\frac{\\dot{\\E}_2 \\lambda u^{2}}{2} + \\frac{\\dot{\\E}_3 \\dot{u}_0^{2} \\lambda^{3} u}{2} - \\frac{\\dot{\\E}_3 \\dot{u}_0 \\lambda^{2} u^{2}}{2} + \\frac{\\dot{\\E}_3 \\lambda u^{3}}{6}\\)\n\n\nSome of the previous symbolic results are now saved for further use in the subsequent notebooks.\n\nimport json\n\ndata = {\n    \"E\" : srepr(E),\n    \"u_star\": srepr(u_star)\n}\n\nwith open(\"setting-up_the_computational_stage.out.json\", \"w\") as f:\n    json.dump(data, f)"
  }
]